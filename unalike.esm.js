/*!
* unalike-js v0.13.2
* (c) 2020 Unalike <hello@unalike.net> (https://unalike.net/)
* Released under the MIT License.
*/
import fetch from"cross-fetch";function asyncGeneratorStep(t,e,r,n,o,i,a){try{var s=t[i](a),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(n,o)}function _asyncToGenerator(t){return function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(t){asyncGeneratorStep(i,n,o,a,s,"next",t)}function s(t){asyncGeneratorStep(i,n,o,a,s,"throw",t)}a(void 0)})}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _construct(t,e,r){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&_setPrototypeOf(o,r.prototype),o}).apply(null,arguments)}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,t)})(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _possibleConstructorReturn(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(t):e}function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _iterableToArrayLimit(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}var version="0.13.2";function createCommonjsModule(t,e){return t(e={exports:{}},e.exports),e.exports}var runtime_1=createCommonjsModule(function(t){var e=function(t){var e,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(t,e,r,n){var o=e&&e.prototype instanceof d?e:d,i=Object.create(o.prototype),a=new S(n||[]);return i._invoke=function(t,e,r){var n=l;return function(o,i){if(n===f)throw new Error("Generator is already running");if(n===p){if("throw"===o)throw i;return j()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=O(a,r);if(s){if(s===y)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var u=c(t,e,r);if("normal"===u.type){if(n=r.done?p:h,u.arg===y)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=p,r.method="throw",r.arg=u.arg)}}}(t,r,a),i}function c(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var l="suspendedStart",h="suspendedYield",f="executing",p="completed",y={};function d(){}function v(){}function g(){}var b={};b[i]=function(){return this};var m=Object.getPrototypeOf,k=m&&m(m(T([])));k&&k!==r&&n.call(k,i)&&(b=k);var w=g.prototype=d.prototype=Object.create(b);function _(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function x(t){var e;this._invoke=function(r,o){function i(){return new Promise(function(e,i){!function e(r,o,i,a){var s=c(t[r],t,o);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==typeof l&&n.call(l,"__await")?Promise.resolve(l.__await).then(function(t){e("next",t,i,a)},function(t){e("throw",t,i,a)}):Promise.resolve(l).then(function(t){u.value=t,i(u)},function(t){return e("throw",t,i,a)})}a(s.arg)}(r,o,e,i)})}return e=e?e.then(i,i):i()}}function O(t,r){var n=t.iterator[r.method];if(n===e){if(r.delegate=null,"throw"===r.method){if(t.iterator.return&&(r.method="return",r.arg=e,O(t,r),"throw"===r.method))return y;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return y}var o=c(n,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var i=o.arg;return i?i.done?(r[t.resultName]=i.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,y):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function R(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function T(t){if(t){var r=t[i];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function r(){for(;++o<t.length;)if(n.call(t,o))return r.value=t[o],r.done=!1,r;return r.value=e,r.done=!0,r};return a.next=a}}return{next:j}}function j(){return{value:e,done:!0}}return v.prototype=w.constructor=g,g.constructor=v,g[s]=v.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,g):(t.__proto__=g,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},_(x.prototype),x.prototype[a]=function(){return this},t.AsyncIterator=x,t.async=function(e,r,n,o){var i=new x(u(e,r,n,o));return t.isGeneratorFunction(r)?i:i.next().then(function(t){return t.done?t.value:i.next()})},_(w),w[s]="Generator",w[i]=function(){return this},w.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=T,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function o(n,o){return s.type="throw",s.arg=t,r.next=n,o&&(r.method="next",r.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var u=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),R(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;R(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:T(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),y}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}}),Resource=function(){function t(e){_classCallCheck(this,t),this.client=e,this.variables={}}return _createClass(t,[{key:"id",value:function(t){return this.variables.id=t,this}}]),t}(),ContentResource=function(t){function e(t){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))}return _inherits(e,Resource),_createClass(e,[{key:"repository",value:function(t){return this.variables.repository=t,this}},{key:"sortBy",value:function(t){return this.variables.sortBy=t,this}},{key:"sortUp",value:function(){return this.variables.sortDirection="ASC",this}},{key:"sortDown",value:function(){return this.variables.sortDirection="DESC",this}},{key:"pageSize",value:function(t){return this.variables.pageSize=t,this}},{key:"page",value:function(t){return this.variables.page=t,this}},{key:"type",value:function(t){return this.variables.type=t,this}},{key:"status",value:function(t){return this.variables.status=t,this}},{key:"published",value:function(){return this.variables.published=!0,this}},{key:"fetch",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var r,n,o,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.variables.id){t.next=6;break}return r={id:this.variables.id},t.next=4,this.client.query("query content($id: ID!) {\n                content(id: $id) {\n                    ".concat(e,"\n                }\n            }"),r);case 4:return n=t.sent,t.abrupt("return",{data:n.data.content});case 6:return o={repositoryId:this.variables.repository,sortBy:this.variables.sortBy,sortDirection:this.variables.sortDirection,pageSize:this.variables.pageSize,page:this.variables.page,type:this.variables.type,status:this.variables.status,published:this.variables.published},t.next=9,this.client.query("query contents($repositoryId: ID!, $sortBy: String, $sortDirection: String, $pageSize: Int, $page: Int, $type: [String], $status: [String], $published: Boolean) {\n            contents(repositoryId: $repositoryId, sortBy: $sortBy, sortDirection: $sortDirection, pageSize: $pageSize, page: $page, type: $type, status: $status, published: $published) {\n                ".concat(e,"\n            }\n        }"),o);case 9:return i=t.sent,t.abrupt("return",{data:i.data.contents});case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"delete",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.variables.id){t.next=2;break}throw new Error("Content ID needs to be supplied before you can delete.");case 2:return e={contentId:this.variables.id},t.next=5,this.client.query("mutation deleteContent($contentId: ID!) {\n            deleteContent(contentId: $contentId) {\n                id\n                name\n            }\n        }",e);case 5:return r=t.sent,t.abrupt("return",{data:r.data.deleteContent});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}]),e}(),RepositoryResource=function(t){function e(t){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))}return _inherits(e,Resource),_createClass(e,[{key:"repository",value:function(t){return this.variables.repository=t,this}},{key:"fetch",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var r,n,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.variables.id){t.next=6;break}return r={slug:this.variables.id},t.next=4,this.client.query("query repository($slug: String) {\n                repository(slug: $slug) {\n                    ".concat(e,"\n                }\n            }"),r);case 4:return n=t.sent,t.abrupt("return",{data:n.data.repository});case 6:return t.next=8,this.client.query("query { \n            repositories { \n                ".concat(e,"\n            }\n        }"));case 8:return o=t.sent,t.abrupt("return",{data:o.data.repositories});case 10:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}]),e}(),ModelResource=function(t){function e(t){return _classCallCheck(this,e),_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))}return _inherits(e,Resource),_createClass(e,[{key:"repository",value:function(t){return this.variables.repository=t,this}},{key:"sortBy",value:function(t){return this.variables.sortBy=t,this}},{key:"sortUp",value:function(){return this.variables.sortDirection="ASC",this}},{key:"sortDown",value:function(){return this.variables.sortDirection="DESC",this}},{key:"pageSize",value:function(t){return this.variables.pageSize=t,this}},{key:"page",value:function(t){return this.variables.page=t,this}},{key:"status",value:function(t){return this.variables.status=t,this}},{key:"fetch",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e){var r,n,o,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.variables.id){t.next=6;break}return r={id:this.variables.id},t.next=4,this.client.query("query model($id: ID!) {\n                model(id: $id) {\n                    ".concat(e,"\n                }\n            }"),r);case 4:return n=t.sent,t.abrupt("return",{data:n.data.model});case 6:return o={repositoryId:this.variables.repository,sortBy:this.variables.sortBy,sortDirection:this.variables.sortDirection,pageSize:this.variables.pageSize,page:this.variables.page,status:this.variables.status},t.next=9,this.client.query("query models($repositoryId: ID!, $sortBy: String, $sortDirection: String, $pageSize: Int, $page: Int, $type: [String], $status: [String]) {\n            models(repositoryId: $repositoryId, sortBy: $sortBy, sortDirection: $sortDirection, pageSize: $pageSize, page: $page, type: $type, status: $status) {\n                ".concat(e,"\n            }\n        }"),o);case 9:return i=t.sent,t.abrupt("return",{data:i.data.models});case 11:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},{key:"delete",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.variables.id){t.next=2;break}throw new Error("Model ID needs to be supplied before you can delete.");case 2:return e={modelId:this.variables.id},t.next=5,this.client.query("mutation deleteModel($modelId: ID!) {\n            deleteModel(modelId: $modelId) {\n                id\n                name\n            }\n        }",e);case 5:return r=t.sent,t.abrupt("return",{data:r.data.deleteModel});case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()}]),e}(),UnalikeError=function(t){function e(t){var r;_classCallCheck(this,e);var n="Unknown error";return t.body&&t.body.message?n=t.body.message:t.data&&t.data.message?n=t.data.message:t.data.errors&&t.data.errors.length>0&&t.data.errors[0].message&&(n=t.data.errors[0].message),(r=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,n))).status=t.status,r}return _inherits(e,_wrapNativeSuper(Error)),e}(),UnalikeQueryError=function(t){function e(t){var r;return _classCallCheck(this,e),(r=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,"Query error"))).errors=t.data.errors,r.status=t.status,r}return _inherits(e,_wrapNativeSuper(Error)),e}(),Interceptors=function(){function t(){_classCallCheck(this,t),this.handlers=[]}return _createClass(t,[{key:"use",value:function(t){return this.handlers.push(t),this.handlers.length-1}},{key:"forEach",value:function(t){var e=!0,r=!1,n=void 0;try{for(var o,i=this.handlers[Symbol.iterator]();!(e=(o=i.next()).done);e=!0){(0,o.value)(t)}}catch(t){r=!0,n=t}finally{try{e||null==i.return||i.return()}finally{if(r)throw n}}}}]),t}(),DEFAULT_TIMEOUT=6e3,Unalike=function(){function t(){var e=this;_classCallCheck(this,t),this.debug=!1,this.options={timeout:DEFAULT_TIMEOUT,headers:{"Unalike-Agent":"unalike.js-".concat(version),"Content-Type":"application/json; charset=utf-8"}},this.content=function(t){var r=new ContentResource(e);return t&&r.id(t),r},this.repository=function(t){var r=new RepositoryResource(e);return t&&r.id(t),r},this.model=function(t){var r=new ModelResource(e);return t&&r.id(t),r},this.interceptors={request:new Interceptors,fulfilled:new Interceptors,rejected:new Interceptors}}return _createClass(t,[{key:"setTimeout",value:function(t){this.options.timeout=t}},{key:"setOption",value:function(t,e){this.options[t]=e}},{key:"setApi",value:function(t){this.url=t}},{key:"setDebug",value:function(t){this.debug=t}},{key:"getUrl",value:function(){return this.url}},{key:"getVersion",value:function(){return"unalike.js-".concat(version)}},{key:"setToken",value:function(t){if(null!=t){if(this.token=t,t.indexOf("__")>-1&&t.indexOf("__")<40){var e=t.split("__")[0];this.url=e.indexOf("localhost")>-1?"http://".concat(e):"https://".concat(e)}this.options.headers["x-auth"]=t}}},{key:"setHeader",value:function(t,e){this.options.headers[t]=e}},{key:"buildUrl",value:function(t,e){var r="";for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];r+=encodeURIComponent(n)+"="+encodeURIComponent(o)+"&"}return r.length>0&&(t=t+"?"+(r=r.substring(0,r.length-1))),t}},{key:"requiresToken",value:function(){if(void 0===this.token||null===this.token)throw new Error("Where's the key?")}},{key:"ping",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.request("".concat(this.url,"/ping"),Object.assign(this.options,{method:"GET"}));case 2:return e=t.sent,this.debug&&(console.log("unalike-js","url","/ping"),console.log("unalike-js","method","GET"),console.log("unalike-js","res",e)),t.abrupt("return",e);case 5:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"get",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e,r){var n,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.buildUrl("".concat(this.url).concat(e),r),t.next=3,this.request(n,Object.assign({},this.options,{method:"GET",body:void 0}));case 3:return o=t.sent,this.debug&&(console.log("unalike-js","url",n),console.log("unalike-js","method","GET"),console.log("unalike-js","response",o)),t.abrupt("return",o);case 6:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()},{key:"post",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e,r,n,o){var i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=this.buildUrl("".concat(this.url).concat(e),r),t.next=3,this.request(i,Object.assign({},this.options,{method:"POST",body:n?JSON.stringify(n):null},o));case 3:return a=t.sent,this.debug&&(console.log("unalike-js","url",i),console.log("unalike-js","method","POST"),console.log("unalike-js","response",a)),t.abrupt("return",a);case 6:case"end":return t.stop()}},t,this)}));return function(e,r,n,o){return t.apply(this,arguments)}}()},{key:"put",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e,r,n){var o,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.requiresToken(),o=this.buildUrl("".concat(this.url).concat(e),r),t.next=4,this.request(o,Object.assign({},this.options,{method:"PUT",body:n?JSON.stringify(n):null}));case 4:return i=t.sent,this.debug&&(console.log("unalike-js","url",o),console.log("unalike-js","method","PUT"),console.log("unalike-js","response",i)),t.abrupt("return",i);case 7:case"end":return t.stop()}},t,this)}));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"delete",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e,r){var n,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.requiresToken(),n=this.buildUrl("".concat(this.url).concat(e),r),t.next=4,this.request(n,Object.assign({},this.options,{method:"DELETE"}));case 4:return o=t.sent,this.debug&&(console.log("unalike-js","url",n),console.log("unalike-js","method","DELETE"),console.log("unalike-js","response",o)),t.abrupt("return",o);case 7:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()},{key:"query",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e,r){var n,o,i,a=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.length>2&&void 0!==a[2]?a[2]:"/query",o=this.buildUrl("".concat(this.url).concat(n)),t.next=4,this.request(o,Object.assign({},this.options,{method:"POST",body:JSON.stringify({query:e,variables:r})}));case 4:if(!((i=t.sent)&&i.data.errors&&i.data.errors.length>0)){t.next=7;break}throw new UnalikeQueryError(i);case 7:return i.data=i.data.data,this.debug&&(console.log("unalike-js","url",o),console.log("unalike-js","method","POST"),console.log("unalike-js","response",i)),t.abrupt("return",i);case 10:case"end":return t.stop()}},t,this)}));return function(e,r){return t.apply(this,arguments)}}()},{key:"request",value:function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(e,r){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(o,i){var a,s,u,c,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=setTimeout(function(){i(new Error("Request timed out"))},r.timeout),t.prev=1,n.interceptors.request.forEach(r),t.next=5,fetch(e,r);case 5:return s=t.sent,t.next=8,s.json();case 8:if(u=t.sent,clearTimeout(a),c={},_toConsumableArray(s.headers.entries()).forEach(function(t){var e=_slicedToArray(t,2),r=e[0],n=e[1];c[r]=n}),!((l={headers:c,status:s.status,data:u}).status>=400)){t.next=18;break}throw new UnalikeError(l);case 18:n.interceptors.fulfilled.forEach(l);case 19:o(l),t.next=26;break;case 22:t.prev=22,t.t0=t.catch(1),n.interceptors.rejected.forEach(t.t0),i(t.t0);case 26:case"end":return t.stop()}},t,null,[[1,22]])}));return function(e,r){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t)}));return function(e,r){return t.apply(this,arguments)}}()}]),t}();export default Unalike;
