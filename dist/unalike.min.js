/*!
* unalike-js v0.17.4
* (c) 2021 Unalike <hello@unalike.net> (https://www.unalike.net/)
* Released under the MIT License.
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("http"),require("https"),require("url"),require("stream"),require("assert"),require("tty"),require("util"),require("os"),require("zlib")):"function"==typeof define&&define.amd?define(["http","https","url","stream","assert","tty","util","os","zlib"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).unalike=t(e.require$$1$1,e.require$$2,e.require$$0$3,e.require$$3,e.require$$4,e.require$$0$2,e.require$$1,e.require$$0$1,e.require$$8$1)}(this,(function(require$$1$1,require$$2,require$$0$3,require$$3,require$$4,require$$0$2,require$$1,require$$0$1,require$$8$1){"use strict";function _interopDefaultLegacy(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var require$$1__default$1=_interopDefaultLegacy(require$$1$1),require$$2__default=_interopDefaultLegacy(require$$2),require$$0__default$2=_interopDefaultLegacy(require$$0$3),require$$3__default=_interopDefaultLegacy(require$$3),require$$4__default=_interopDefaultLegacy(require$$4),require$$0__default$1=_interopDefaultLegacy(require$$0$2),require$$1__default=_interopDefaultLegacy(require$$1),require$$0__default=_interopDefaultLegacy(require$$0$1),require$$8__default=_interopDefaultLegacy(require$$8$1);function asyncGeneratorStep$9(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator$9(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){asyncGeneratorStep$9(s,n,i,o,a,"next",e)}function a(e){asyncGeneratorStep$9(s,n,i,o,a,"throw",e)}o(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _construct(e,t,r){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var i=new(Function.bind.apply(e,n));return r&&_setPrototypeOf(i,r.prototype),i}).apply(null,arguments)}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,e)})(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _possibleConstructorReturn(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?_assertThisInitialized(e):t}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var r,n=_getPrototypeOf(e);if(t){var i=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function _createForOfIteratorHelper(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,s=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw s}}}}var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},runtime={exports:{}};!function(e){var t=function(e){var t,r=Object.prototype,n=r.hasOwnProperty,i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",o=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function u(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(e){u=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var i=t&&t.prototype instanceof y?t:y,s=Object.create(i.prototype),o=new O(n||[]);return s._invoke=function(e,t,r){var n=p;return function(i,s){if(n===d)throw new Error("Generator is already running");if(n===f){if("throw"===i)throw s;return E()}for(r.method=i,r.arg=s;;){var o=r.delegate;if(o){var a=w(o,r);if(a){if(a===_)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===p)throw n=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=d;var u=l(e,t,r);if("normal"===u.type){if(n=r.done?f:h,u.arg===_)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n=f,r.method="throw",r.arg=u.arg)}}}(e,r,o),s}function l(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var p="suspendedStart",h="suspendedYield",d="executing",f="completed",_={};function y(){}function m(){}function v(){}var g={};g[s]=function(){return this};var b=Object.getPrototypeOf,$=b&&b(b(S([])));$&&$!==r&&n.call($,s)&&(g=$);var k=v.prototype=y.prototype=Object.create(g);function T(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function C(e,t){function r(i,s,o,a){var u=l(e[i],e,s);if("throw"!==u.type){var c=u.arg,p=c.value;return p&&"object"==typeof p&&n.call(p,"__await")?t.resolve(p.__await).then((function(e){r("next",e,o,a)}),(function(e){r("throw",e,o,a)})):t.resolve(p).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,a)}))}a(u.arg)}var i;this._invoke=function(e,n){function s(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(s,s):s()}}function w(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,w(e,r),"throw"===r.method))return _;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var i=l(n,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,_;var s=i.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,_):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,_)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function x(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function S(e){if(e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}return{next:E}}function E(){return{value:t,done:!0}}return m.prototype=k.constructor=v,v.constructor=m,m.displayName=u(v,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,u(e,a,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},T(C.prototype),C.prototype[o]=function(){return this},e.AsyncIterator=C,e.async=function(t,r,n,i,s){void 0===s&&(s=Promise);var o=new C(c(t,r,n,i),s);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},T(k),u(k,a,"Generator"),k[s]=function(){return this},k.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=S,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(x),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],a=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,_):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),x(r),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;x(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:S(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),_}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}(runtime);var version$2="0.17.4",axios$2={exports:{}},bind$2=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}},bind$1=bind$2,toString=Object.prototype.toString;function isArray(e){return"[object Array]"===toString.call(e)}function isUndefined(e){return void 0===e}function isBuffer(e){return null!==e&&!isUndefined(e)&&null!==e.constructor&&!isUndefined(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function isArrayBuffer(e){return"[object ArrayBuffer]"===toString.call(e)}function isFormData(e){return"undefined"!=typeof FormData&&e instanceof FormData}function isArrayBufferView(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function isString(e){return"string"==typeof e}function isNumber(e){return"number"==typeof e}function isObject(e){return null!==e&&"object"==typeof e}function isPlainObject(e){if("[object Object]"!==toString.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function isDate(e){return"[object Date]"===toString.call(e)}function isFile(e){return"[object File]"===toString.call(e)}function isBlob(e){return"[object Blob]"===toString.call(e)}function isFunction(e){return"[object Function]"===toString.call(e)}function isStream(e){return isObject(e)&&isFunction(e.pipe)}function isURLSearchParams(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function trim(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function isStandardBrowserEnv(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function forEach(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),isArray(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}function merge(){var e={};function t(t,r){isPlainObject(e[r])&&isPlainObject(t)?e[r]=merge(e[r],t):isPlainObject(t)?e[r]=merge({},t):isArray(t)?e[r]=t.slice():e[r]=t}for(var r=0,n=arguments.length;r<n;r++)forEach(arguments[r],t);return e}function extend(e,t,r){return forEach(t,(function(t,n){e[n]=r&&"function"==typeof t?bind$1(t,r):t})),e}function stripBOM(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}var utils$e={isArray:isArray,isArrayBuffer:isArrayBuffer,isBuffer:isBuffer,isFormData:isFormData,isArrayBufferView:isArrayBufferView,isString:isString,isNumber:isNumber,isObject:isObject,isPlainObject:isPlainObject,isUndefined:isUndefined,isDate:isDate,isFile:isFile,isBlob:isBlob,isFunction:isFunction,isStream:isStream,isURLSearchParams:isURLSearchParams,isStandardBrowserEnv:isStandardBrowserEnv,forEach:forEach,merge:merge,extend:extend,trim:trim,stripBOM:stripBOM},utils$d=utils$e;function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var buildURL$3=function(e,t,r){if(!t)return e;var n;if(r)n=r(t);else if(utils$d.isURLSearchParams(t))n=t.toString();else{var i=[];utils$d.forEach(t,(function(e,t){null!=e&&(utils$d.isArray(e)?t+="[]":e=[e],utils$d.forEach(e,(function(e){utils$d.isDate(e)?e=e.toISOString():utils$d.isObject(e)&&(e=JSON.stringify(e)),i.push(encode(t)+"="+encode(e))})))})),n=i.join("&")}if(n){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+n}return e},utils$c=utils$e;function InterceptorManager$1(){this.handlers=[]}InterceptorManager$1.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},InterceptorManager$1.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},InterceptorManager$1.prototype.forEach=function(e){utils$c.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var InterceptorManager_1=InterceptorManager$1,utils$b=utils$e,transformData$1=function(e,t,r){return utils$b.forEach(r,(function(r){e=r(e,t)})),e},isCancel$1=function(e){return!(!e||!e.__CANCEL__)},utils$a=utils$e,normalizeHeaderName$1=function(e,t){utils$a.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))},enhanceError$2=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e},enhanceError$1=enhanceError$2,createError$3=function(e,t,r,n,i){var s=new Error(e);return enhanceError$1(s,t,r,n,i)},createError$2=createError$3,settle$2=function(e,t,r){var n=r.config.validateStatus;r.status&&n&&!n(r.status)?t(createError$2("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)},utils$9=utils$e,cookies$1=utils$9.isStandardBrowserEnv()?{write:function(e,t,r,n,i,s){var o=[];o.push(e+"="+encodeURIComponent(t)),utils$9.isNumber(r)&&o.push("expires="+new Date(r).toGMTString()),utils$9.isString(n)&&o.push("path="+n),utils$9.isString(i)&&o.push("domain="+i),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},isAbsoluteURL$1=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)},combineURLs$1=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e},isAbsoluteURL=isAbsoluteURL$1,combineURLs=combineURLs$1,buildFullPath$2=function(e,t){return e&&!isAbsoluteURL(t)?combineURLs(e,t):t},utils$8=utils$e,ignoreDuplicateOf=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],parseHeaders$1=function(e){var t,r,n,i={};return e?(utils$8.forEach(e.split("\n"),(function(e){if(n=e.indexOf(":"),t=utils$8.trim(e.substr(0,n)).toLowerCase(),r=utils$8.trim(e.substr(n+1)),t){if(i[t]&&ignoreDuplicateOf.indexOf(t)>=0)return;i[t]="set-cookie"===t?(i[t]?i[t]:[]).concat([r]):i[t]?i[t]+", "+r:r}})),i):i},utils$7=utils$e,isURLSameOrigin$1=utils$7.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function n(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=n(window.location.href),function(t){var r=utils$7.isString(t)?n(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0},utils$6=utils$e,settle$1=settle$2,cookies=cookies$1,buildURL$2=buildURL$3,buildFullPath$1=buildFullPath$2,parseHeaders=parseHeaders$1,isURLSameOrigin=isURLSameOrigin$1,createError$1=createError$3,xhr=function(e){return new Promise((function(t,r){var n=e.data,i=e.headers;utils$6.isFormData(n)&&delete i["Content-Type"];var s=new XMLHttpRequest;if(e.auth){var o=e.auth.username||"",a=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";i.Authorization="Basic "+btoa(o+":"+a)}var u=buildFullPath$1(e.baseURL,e.url);if(s.open(e.method.toUpperCase(),buildURL$2(u,e.params,e.paramsSerializer),!0),s.timeout=e.timeout,s.onreadystatechange=function(){if(s&&4===s.readyState&&(0!==s.status||s.responseURL&&0===s.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in s?parseHeaders(s.getAllResponseHeaders()):null,i={data:e.responseType&&"text"!==e.responseType?s.response:s.responseText,status:s.status,statusText:s.statusText,headers:n,config:e,request:s};settle$1(t,r,i),s=null}},s.onabort=function(){s&&(r(createError$1("Request aborted",e,"ECONNABORTED",s)),s=null)},s.onerror=function(){r(createError$1("Network Error",e,null,s)),s=null},s.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(createError$1(t,e,"ECONNABORTED",s)),s=null},utils$6.isStandardBrowserEnv()){var c=(e.withCredentials||isURLSameOrigin(u))&&e.xsrfCookieName?cookies.read(e.xsrfCookieName):void 0;c&&(i[e.xsrfHeaderName]=c)}if("setRequestHeader"in s&&utils$6.forEach(i,(function(e,t){void 0===n&&"content-type"===t.toLowerCase()?delete i[t]:s.setRequestHeader(t,e)})),utils$6.isUndefined(e.withCredentials)||(s.withCredentials=!!e.withCredentials),e.responseType)try{s.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&s.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&s.upload&&s.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){s&&(s.abort(),r(e),s=null)})),n||(n=null),s.send(n)}))},followRedirects={exports:{}},src={exports:{}},browser$1={exports:{}},s=1e3,m=60*s,h=60*m,d=24*h,w=7*d,y=365.25*d,ms=function(e,t){t=t||{};var r=typeof e;if("string"===r&&e.length>0)return parse(e);if("number"===r&&isFinite(e))return t.long?fmtLong(e):fmtShort(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function parse(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return r*y;case"weeks":case"week":case"w":return r*w;case"days":case"day":case"d":return r*d;case"hours":case"hour":case"hrs":case"hr":case"h":return r*h;case"minutes":case"minute":case"mins":case"min":case"m":return r*m;case"seconds":case"second":case"secs":case"sec":case"s":return r*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function fmtShort(e){var t=Math.abs(e);return t>=d?Math.round(e/d)+"d":t>=h?Math.round(e/h)+"h":t>=m?Math.round(e/m)+"m":t>=s?Math.round(e/s)+"s":e+"ms"}function fmtLong(e){var t=Math.abs(e);return t>=d?plural(e,t,d,"day"):t>=h?plural(e,t,h,"hour"):t>=m?plural(e,t,m,"minute"):t>=s?plural(e,t,s,"second"):e+" ms"}function plural(e,t,r,n){var i=t>=1.5*r;return Math.round(e/r)+" "+n+(i?"s":"")}function setup(e){function t(e){let n,i=null;function s(...e){if(!s.enabled)return;const r=s,i=Number(new Date),o=i-(n||i);r.diff=o,r.prev=n,r.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((n,i)=>{if("%%"===n)return"%";a++;const s=t.formatters[i];if("function"==typeof s){const t=e[a];n=s.call(r,t),e.splice(a,1),a--}return n})),t.formatArgs.call(r,e);(r.log||t.log).apply(r,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=r,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null===i?t.enabled(e):i,set:e=>{i=e}}),"function"==typeof t.init&&t.init(s),s}function r(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(n),...t.skips.map(n).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),i=n.length;for(r=0;r<i;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=ms,t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}var common=setup;!function(e,t){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(i=n))})),t.splice(i,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=common(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}(browser$1,browser$1.exports);var node={exports:{}},hasFlag$1=(e,t)=>{t=t||process.argv;const r=e.startsWith("-")?"":1===e.length?"-":"--",n=t.indexOf(r+e),i=t.indexOf("--");return-1!==n&&(-1===i||n<i)};const os=require$$0__default.default,hasFlag=hasFlag$1,env=process.env;let forceColor;function translateLevel(e){return 0!==e&&{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function supportsColor(e){if(!1===forceColor)return 0;if(hasFlag("color=16m")||hasFlag("color=full")||hasFlag("color=truecolor"))return 3;if(hasFlag("color=256"))return 2;if(e&&!e.isTTY&&!0!==forceColor)return 0;const t=forceColor?1:0;if("win32"===process.platform){const e=os.release().split(".");return Number(process.versions.node.split(".")[0])>=8&&Number(e[0])>=10&&Number(e[2])>=10586?Number(e[2])>=14931?3:2:1}if("CI"in env)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some((e=>e in env))||"codeship"===env.CI_NAME?1:t;if("TEAMCITY_VERSION"in env)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(env.TEAMCITY_VERSION)?1:0;if("truecolor"===env.COLORTERM)return 3;if("TERM_PROGRAM"in env){const e=parseInt((env.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(env.TERM_PROGRAM){case"iTerm.app":return e>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(env.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(env.TERM)||"COLORTERM"in env?1:(env.TERM,t)}function getSupportLevel(e){return translateLevel(supportsColor(e))}hasFlag("no-color")||hasFlag("no-colors")||hasFlag("color=false")?forceColor=!1:(hasFlag("color")||hasFlag("colors")||hasFlag("color=true")||hasFlag("color=always"))&&(forceColor=!0),"FORCE_COLOR"in env&&(forceColor=0===env.FORCE_COLOR.length||0!==parseInt(env.FORCE_COLOR,10));var supportsColor_1={supportsColor:getSupportLevel,stdout:getSupportLevel(process.stdout),stderr:getSupportLevel(process.stderr)},debug$1;!function(e,t){const r=require$$0__default$1.default,n=require$$1__default.default;t.init=function(e){e.inspectOpts={};const r=Object.keys(t.inspectOpts);for(let n=0;n<r.length;n++)e.inspectOpts[r[n]]=t.inspectOpts[r[n]]},t.log=function(...e){return process.stderr.write(n.format(...e)+"\n")},t.formatArgs=function(r){const{namespace:n,useColors:i}=this;if(i){const t=this.color,i="[3"+(t<8?t:"8;5;"+t),s=`  ${i};1m${n} [0m`;r[0]=s+r[0].split("\n").join("\n"+s),r.push(i+"m+"+e.exports.humanize(this.diff)+"[0m")}else r[0]=function(){if(t.inspectOpts.hideDate)return"";return(new Date).toISOString()+" "}()+n+" "+r[0]},t.save=function(e){e?process.env.DEBUG=e:delete process.env.DEBUG},t.load=function(){return process.env.DEBUG},t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(process.stderr.fd)},t.destroy=n.deprecate((()=>{}),"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."),t.colors=[6,2,3,4,5,1];try{const e=supportsColor_1;e&&(e.stderr||e).level>=2&&(t.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch(e){}t.inspectOpts=Object.keys(process.env).filter((e=>/^debug_/i.test(e))).reduce(((e,t)=>{const r=t.substring(6).toLowerCase().replace(/_([a-z])/g,((e,t)=>t.toUpperCase()));let n=process.env[t];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),e[r]=n,e}),{}),e.exports=common(t);const{formatters:i}=e.exports;i.o=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts).split("\n").map((e=>e.trim())).join(" ")},i.O=function(e){return this.inspectOpts.colors=this.useColors,n.inspect(e,this.inspectOpts)}}(node,node.exports),"undefined"==typeof process||"renderer"===process.type||!0===process.browser||process.__nwjs?src.exports=browser$1.exports:src.exports=node.exports;var debug_1=function(){if(!debug$1)try{debug$1=src.exports("follow-redirects")}catch(e){debug$1=function(){}}debug$1.apply(null,arguments)},url$3=require$$0__default$2.default,URL=url$3.URL,http$1=require$$1__default$1.default,https$1=require$$2__default.default,Writable=require$$3__default.default.Writable,assert=require$$4__default.default,debug=debug_1,eventHandlers=Object.create(null);["abort","aborted","connect","error","socket","timeout"].forEach((function(e){eventHandlers[e]=function(t,r,n){this._redirectable.emit(e,t,r,n)}}));var RedirectionError=createErrorType("ERR_FR_REDIRECTION_FAILURE",""),TooManyRedirectsError=createErrorType("ERR_FR_TOO_MANY_REDIRECTS","Maximum number of redirects exceeded"),MaxBodyLengthExceededError=createErrorType("ERR_FR_MAX_BODY_LENGTH_EXCEEDED","Request body larger than maxBodyLength limit"),WriteAfterEndError=createErrorType("ERR_STREAM_WRITE_AFTER_END","write after end");function RedirectableRequest(e,t){Writable.call(this),this._sanitizeOptions(e),this._options=e,this._ended=!1,this._ending=!1,this._redirectCount=0,this._redirects=[],this._requestBodyLength=0,this._requestBodyBuffers=[],t&&this.on("response",t);var r=this;this._onNativeResponse=function(e){r._processResponse(e)},this._performRequest()}function startTimer(e,t){clearTimeout(e._timeout),e._timeout=setTimeout((function(){e.emit("timeout")}),t)}function clearTimer(){clearTimeout(this._timeout)}function wrap(e){var t={maxRedirects:21,maxBodyLength:10485760},r={};return Object.keys(e).forEach((function(n){var i=n+":",s=r[i]=e[n],o=t[n]=Object.create(s);Object.defineProperties(o,{request:{value:function(e,n,s){if("string"==typeof e){var o=e;try{e=urlToOptions(new URL(o))}catch(t){e=url$3.parse(o)}}else URL&&e instanceof URL?e=urlToOptions(e):(s=n,n=e,e={protocol:i});return"function"==typeof n&&(s=n,n=null),(n=Object.assign({maxRedirects:t.maxRedirects,maxBodyLength:t.maxBodyLength},e,n)).nativeProtocols=r,assert.equal(n.protocol,i,"protocol mismatch"),debug("options",n),new RedirectableRequest(n,s)},configurable:!0,enumerable:!0,writable:!0},get:{value:function(e,t,r){var n=o.request(e,t,r);return n.end(),n},configurable:!0,enumerable:!0,writable:!0}})})),t}function noop(){}function urlToOptions(e){var t={protocol:e.protocol,hostname:e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:e.pathname+e.search,href:e.href};return""!==e.port&&(t.port=Number(e.port)),t}function removeMatchingHeaders(e,t){var r;for(var n in t)e.test(n)&&(r=t[n],delete t[n]);return r}function createErrorType(e,t){function r(e){Error.captureStackTrace(this,this.constructor),this.message=e||t}return r.prototype=new Error,r.prototype.constructor=r,r.prototype.name="Error ["+e+"]",r.prototype.code=e,r}RedirectableRequest.prototype=Object.create(Writable.prototype),RedirectableRequest.prototype.write=function(e,t,r){if(this._ending)throw new WriteAfterEndError;if(!("string"==typeof e||"object"==typeof e&&"length"in e))throw new TypeError("data should be a string, Buffer or Uint8Array");"function"==typeof t&&(r=t,t=null),0!==e.length?this._requestBodyLength+e.length<=this._options.maxBodyLength?(this._requestBodyLength+=e.length,this._requestBodyBuffers.push({data:e,encoding:t}),this._currentRequest.write(e,t,r)):(this.emit("error",new MaxBodyLengthExceededError),this.abort()):r&&r()},RedirectableRequest.prototype.end=function(e,t,r){if("function"==typeof e?(r=e,e=t=null):"function"==typeof t&&(r=t,t=null),e){var n=this,i=this._currentRequest;this.write(e,t,(function(){n._ended=!0,i.end(null,null,r)})),this._ending=!0}else this._ended=this._ending=!0,this._currentRequest.end(null,null,r)},RedirectableRequest.prototype.setHeader=function(e,t){this._options.headers[e]=t,this._currentRequest.setHeader(e,t)},RedirectableRequest.prototype.removeHeader=function(e){delete this._options.headers[e],this._currentRequest.removeHeader(e)},RedirectableRequest.prototype.setTimeout=function(e,t){if(t&&this.once("timeout",t),this.socket)startTimer(this,e);else{var r=this;this._currentRequest.once("socket",(function(){startTimer(r,e)}))}return this.once("response",clearTimer),this.once("error",clearTimer),this},["abort","flushHeaders","getHeader","setNoDelay","setSocketKeepAlive"].forEach((function(e){RedirectableRequest.prototype[e]=function(t,r){return this._currentRequest[e](t,r)}})),["aborted","connection","socket"].forEach((function(e){Object.defineProperty(RedirectableRequest.prototype,e,{get:function(){return this._currentRequest[e]}})})),RedirectableRequest.prototype._sanitizeOptions=function(e){if(e.headers||(e.headers={}),e.host&&(e.hostname||(e.hostname=e.host),delete e.host),!e.pathname&&e.path){var t=e.path.indexOf("?");t<0?e.pathname=e.path:(e.pathname=e.path.substring(0,t),e.search=e.path.substring(t))}},RedirectableRequest.prototype._performRequest=function(){var e=this._options.protocol,t=this._options.nativeProtocols[e];if(t){if(this._options.agents){var r=e.substr(0,e.length-1);this._options.agent=this._options.agents[r]}var n=this._currentRequest=t.request(this._options,this._onNativeResponse);for(var i in this._currentUrl=url$3.format(this._options),n._redirectable=this,eventHandlers)i&&n.on(i,eventHandlers[i]);if(this._isRedirect){var s=0,o=this,a=this._requestBodyBuffers;!function e(t){if(n===o._currentRequest)if(t)o.emit("error",t);else if(s<a.length){var r=a[s++];n.finished||n.write(r.data,r.encoding,e)}else o._ended&&n.end()}()}}else this.emit("error",new TypeError("Unsupported protocol "+e))},RedirectableRequest.prototype._processResponse=function(e){var t=e.statusCode;this._options.trackRedirects&&this._redirects.push({url:this._currentUrl,headers:e.headers,statusCode:t});var r=e.headers.location;if(r&&!1!==this._options.followRedirects&&t>=300&&t<400){if(this._currentRequest.removeAllListeners(),this._currentRequest.on("error",noop),this._currentRequest.abort(),e.destroy(),++this._redirectCount>this._options.maxRedirects)return void this.emit("error",new TooManyRedirectsError);((301===t||302===t)&&"POST"===this._options.method||303===t&&!/^(?:GET|HEAD)$/.test(this._options.method))&&(this._options.method="GET",this._requestBodyBuffers=[],removeMatchingHeaders(/^content-/i,this._options.headers));var n=removeMatchingHeaders(/^host$/i,this._options.headers)||url$3.parse(this._currentUrl).hostname,i=url$3.resolve(this._currentUrl,r);debug("redirecting to",i),this._isRedirect=!0;var s=url$3.parse(i);if(Object.assign(this._options,s),s.hostname!==n&&removeMatchingHeaders(/^authorization$/i,this._options.headers),"function"==typeof this._options.beforeRedirect){var o={headers:e.headers};try{this._options.beforeRedirect.call(null,this._options,o)}catch(e){return void this.emit("error",e)}this._sanitizeOptions(this._options)}try{this._performRequest()}catch(e){var a=new RedirectionError("Redirected request failed: "+e.message);a.cause=e,this.emit("error",a)}}else e.responseUrl=this._currentUrl,e.redirects=this._redirects,this.emit("response",e),this._requestBodyBuffers=[]},followRedirects.exports=wrap({http:http$1,https:https$1}),followRedirects.exports.wrap=wrap;var _args=[["axios@0.21.1","/Users/jack/projects/unalike/unalike-js"]],_from="axios@0.21.1",_id="axios@0.21.1",_inBundle=!1,_integrity="sha512-dKQiRHxGD9PPRIUNIWvZhPTPpl1rf/OxTYKsqKUDjBwYylTvV7SjSHJb9ratfyzM6wCdLCOYLzs73qpg5c4iGA==",_location="/axios",_phantomChildren={},_requested={type:"version",registry:!0,raw:"axios@0.21.1",name:"axios",escapedName:"axios",rawSpec:"0.21.1",saveSpec:null,fetchSpec:"0.21.1"},_requiredBy=["/"],_resolved="https://registry.npmjs.org/axios/-/axios-0.21.1.tgz",_spec="0.21.1",_where="/Users/jack/projects/unalike/unalike-js",author={name:"Matt Zabriskie"},browser={"./lib/adapters/http.js":"./lib/adapters/xhr.js"},bugs={url:"https://github.com/axios/axios/issues"},bundlesize=[{path:"./dist/axios.min.js",threshold:"5kB"}],dependencies={"follow-redirects":"^1.10.0"},description="Promise based HTTP client for the browser and node.js",devDependencies={bundlesize:"^0.17.0",coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.0.2","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^20.1.0","grunt-karma":"^2.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^1.0.18","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^1.3.0","karma-chrome-launcher":"^2.2.0","karma-coverage":"^1.1.1","karma-firefox-launcher":"^1.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-opera-launcher":"^1.0.0","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^1.2.0","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.7","karma-webpack":"^1.7.0","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",mocha:"^5.2.0",sinon:"^4.5.0",typescript:"^2.8.1","url-search-params":"^0.10.0",webpack:"^1.13.1","webpack-dev-server":"^1.14.1"},homepage="https://github.com/axios/axios",jsdelivr="dist/axios.min.js",keywords=["xhr","http","ajax","promise","node"],license="MIT",main$1="index.js",name="axios",repository={type:"git",url:"git+https://github.com/axios/axios.git"},scripts={build:"NODE_ENV=production grunt build",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",examples:"node ./examples/server.js",fix:"eslint --fix lib/**/*.js",postversion:"git push && git push --tags",preversion:"npm test",start:"node ./sandbox/server.js",test:"grunt test && bundlesize",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json"},typings="./index.d.ts",unpkg="dist/axios.min.js",version$1="0.21.1",require$$9={_args:_args,_from:_from,_id:_id,_inBundle:_inBundle,_integrity:_integrity,_location:_location,_phantomChildren:_phantomChildren,_requested:_requested,_requiredBy:_requiredBy,_resolved:_resolved,_spec:_spec,_where:_where,author:author,browser:browser,bugs:bugs,bundlesize:bundlesize,dependencies:dependencies,description:description,devDependencies:devDependencies,homepage:homepage,jsdelivr:jsdelivr,keywords:keywords,license:license,main:main$1,name:name,repository:repository,scripts:scripts,typings:typings,unpkg:unpkg,version:version$1},utils$5=utils$e,settle=settle$2,buildFullPath=buildFullPath$2,buildURL$1=buildURL$3,http=require$$1__default$1.default,https=require$$2__default.default,httpFollow=followRedirects.exports.http,httpsFollow=followRedirects.exports.https,url$2=require$$0__default$2.default,zlib=require$$8__default.default,pkg=require$$9,createError=createError$3,enhanceError=enhanceError$2,isHttps=/https:?/;function setProxy(e,t,r){if(e.hostname=t.host,e.host=t.host,e.port=t.port,e.path=r,t.auth){var n=Buffer.from(t.auth.username+":"+t.auth.password,"utf8").toString("base64");e.headers["Proxy-Authorization"]="Basic "+n}e.beforeRedirect=function(e){e.headers.host=e.host,setProxy(e,t,e.href)}}var http_1=function(e){return new Promise((function(t,r){var n=function(e){t(e)},i=function(e){r(e)},s=e.data,o=e.headers;if(o["User-Agent"]||o["user-agent"]||(o["User-Agent"]="axios/"+pkg.version),s&&!utils$5.isStream(s)){if(Buffer.isBuffer(s));else if(utils$5.isArrayBuffer(s))s=Buffer.from(new Uint8Array(s));else{if(!utils$5.isString(s))return i(createError("Data after transformation must be a string, an ArrayBuffer, a Buffer, or a Stream",e));s=Buffer.from(s,"utf-8")}o["Content-Length"]=s.length}var a=void 0;e.auth&&(a=(e.auth.username||"")+":"+(e.auth.password||""));var u=buildFullPath(e.baseURL,e.url),c=url$2.parse(u),l=c.protocol||"http:";if(!a&&c.auth){var p=c.auth.split(":");a=(p[0]||"")+":"+(p[1]||"")}a&&delete o.Authorization;var h=isHttps.test(l),d=h?e.httpsAgent:e.httpAgent,f={path:buildURL$1(c.path,e.params,e.paramsSerializer).replace(/^\?/,""),method:e.method.toUpperCase(),headers:o,agent:d,agents:{http:e.httpAgent,https:e.httpsAgent},auth:a};e.socketPath?f.socketPath=e.socketPath:(f.hostname=c.hostname,f.port=c.port);var _,y=e.proxy;if(!y&&!1!==y){var m=l.slice(0,-1)+"_proxy",v=process.env[m]||process.env[m.toUpperCase()];if(v){var g=url$2.parse(v),b=process.env.no_proxy||process.env.NO_PROXY,$=!0;if(b)$=!b.split(",").map((function(e){return e.trim()})).some((function(e){return!!e&&("*"===e||("."===e[0]&&c.hostname.substr(c.hostname.length-e.length)===e||c.hostname===e))}));if($&&(y={host:g.hostname,port:g.port,protocol:g.protocol},g.auth)){var k=g.auth.split(":");y.auth={username:k[0],password:k[1]}}}}y&&(f.headers.host=c.hostname+(c.port?":"+c.port:""),setProxy(f,y,l+"//"+c.hostname+(c.port?":"+c.port:"")+f.path));var T=h&&(!y||isHttps.test(y.protocol));e.transport?_=e.transport:0===e.maxRedirects?_=T?https:http:(e.maxRedirects&&(f.maxRedirects=e.maxRedirects),_=T?httpsFollow:httpFollow),e.maxBodyLength>-1&&(f.maxBodyLength=e.maxBodyLength);var C=_.request(f,(function(t){if(!C.aborted){var r=t,s=t.req||C;if(204!==t.statusCode&&"HEAD"!==s.method&&!1!==e.decompress)switch(t.headers["content-encoding"]){case"gzip":case"compress":case"deflate":r=r.pipe(zlib.createUnzip()),delete t.headers["content-encoding"]}var o={status:t.statusCode,statusText:t.statusMessage,headers:t.headers,config:e,request:s};if("stream"===e.responseType)o.data=r,settle(n,i,o);else{var a=[];r.on("data",(function(t){a.push(t),e.maxContentLength>-1&&Buffer.concat(a).length>e.maxContentLength&&(r.destroy(),i(createError("maxContentLength size of "+e.maxContentLength+" exceeded",e,null,s)))})),r.on("error",(function(t){C.aborted||i(enhanceError(t,e,null,s))})),r.on("end",(function(){var t=Buffer.concat(a);"arraybuffer"!==e.responseType&&(t=t.toString(e.responseEncoding),e.responseEncoding&&"utf8"!==e.responseEncoding||(t=utils$5.stripBOM(t))),o.data=t,settle(n,i,o)}))}}}));C.on("error",(function(t){C.aborted&&"ERR_FR_TOO_MANY_REDIRECTS"!==t.code||i(enhanceError(t,e,null,C))})),e.timeout&&C.setTimeout(e.timeout,(function(){C.abort(),i(createError("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",C))})),e.cancelToken&&e.cancelToken.promise.then((function(e){C.aborted||(C.abort(),i(e))})),utils$5.isStream(s)?s.on("error",(function(t){i(enhanceError(t,e,null,C))})).pipe(C):C.end(s)}))},utils$4=utils$e,normalizeHeaderName=normalizeHeaderName$1,DEFAULT_CONTENT_TYPE={"Content-Type":"application/x-www-form-urlencoded"};function setContentTypeIfUnset(e,t){!utils$4.isUndefined(e)&&utils$4.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function getDefaultAdapter(){var e;return"undefined"!=typeof XMLHttpRequest?e=xhr:"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process)&&(e=http_1),e}var defaults$2={adapter:getDefaultAdapter(),transformRequest:[function(e,t){return normalizeHeaderName(t,"Accept"),normalizeHeaderName(t,"Content-Type"),utils$4.isFormData(e)||utils$4.isArrayBuffer(e)||utils$4.isBuffer(e)||utils$4.isStream(e)||utils$4.isFile(e)||utils$4.isBlob(e)?e:utils$4.isArrayBufferView(e)?e.buffer:utils$4.isURLSearchParams(e)?(setContentTypeIfUnset(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):utils$4.isObject(e)?(setContentTypeIfUnset(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};utils$4.forEach(["delete","get","head"],(function(e){defaults$2.headers[e]={}})),utils$4.forEach(["post","put","patch"],(function(e){defaults$2.headers[e]=utils$4.merge(DEFAULT_CONTENT_TYPE)}));var defaults_1=defaults$2,utils$3=utils$e,transformData=transformData$1,isCancel=isCancel$1,defaults$1=defaults_1;function throwIfCancellationRequested(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var dispatchRequest$1=function(e){return throwIfCancellationRequested(e),e.headers=e.headers||{},e.data=transformData(e.data,e.headers,e.transformRequest),e.headers=utils$3.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),utils$3.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||defaults$1.adapter)(e).then((function(t){return throwIfCancellationRequested(e),t.data=transformData(t.data,t.headers,e.transformResponse),t}),(function(t){return isCancel(t)||(throwIfCancellationRequested(e),t&&t.response&&(t.response.data=transformData(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},utils$2=utils$e,mergeConfig$2=function(e,t){t=t||{};var r={},n=["url","method","data"],i=["headers","auth","proxy","params"],s=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],o=["validateStatus"];function a(e,t){return utils$2.isPlainObject(e)&&utils$2.isPlainObject(t)?utils$2.merge(e,t):utils$2.isPlainObject(t)?utils$2.merge({},t):utils$2.isArray(t)?t.slice():t}function u(n){utils$2.isUndefined(t[n])?utils$2.isUndefined(e[n])||(r[n]=a(void 0,e[n])):r[n]=a(e[n],t[n])}utils$2.forEach(n,(function(e){utils$2.isUndefined(t[e])||(r[e]=a(void 0,t[e]))})),utils$2.forEach(i,u),utils$2.forEach(s,(function(n){utils$2.isUndefined(t[n])?utils$2.isUndefined(e[n])||(r[n]=a(void 0,e[n])):r[n]=a(void 0,t[n])})),utils$2.forEach(o,(function(n){n in t?r[n]=a(e[n],t[n]):n in e&&(r[n]=a(void 0,e[n]))}));var c=n.concat(i).concat(s).concat(o),l=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===c.indexOf(e)}));return utils$2.forEach(l,u),r},utils$1=utils$e,buildURL=buildURL$3,InterceptorManager=InterceptorManager_1,dispatchRequest=dispatchRequest$1,mergeConfig$1=mergeConfig$2;function Axios$1(e){this.defaults=e,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}Axios$1.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=mergeConfig$1(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[dispatchRequest,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)r=r.then(t.shift(),t.shift());return r},Axios$1.prototype.getUri=function(e){return e=mergeConfig$1(this.defaults,e),buildURL(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},utils$1.forEach(["delete","get","head","options"],(function(e){Axios$1.prototype[e]=function(t,r){return this.request(mergeConfig$1(r||{},{method:e,url:t,data:(r||{}).data}))}})),utils$1.forEach(["post","put","patch"],(function(e){Axios$1.prototype[e]=function(t,r,n){return this.request(mergeConfig$1(n||{},{method:e,url:t,data:r}))}}));var Axios_1=Axios$1;function Cancel$1(e){this.message=e}Cancel$1.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},Cancel$1.prototype.__CANCEL__=!0;var Cancel_1=Cancel$1,Cancel=Cancel_1;function CancelToken(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;e((function(e){r.reason||(r.reason=new Cancel(e),t(r.reason))}))}CancelToken.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},CancelToken.source=function(){var e;return{token:new CancelToken((function(t){e=t})),cancel:e}};var CancelToken_1=CancelToken,spread=function(e){return function(t){return e.apply(null,t)}},isAxiosError=function(e){return"object"==typeof e&&!0===e.isAxiosError},utils=utils$e,bind=bind$2,Axios=Axios_1,mergeConfig=mergeConfig$2,defaults=defaults_1;function createInstance(e){var t=new Axios(e),r=bind(Axios.prototype.request,t);return utils.extend(r,Axios.prototype,t),utils.extend(r,t),r}var axios$1=createInstance(defaults);axios$1.Axios=Axios,axios$1.create=function(e){return createInstance(mergeConfig(axios$1.defaults,e))},axios$1.Cancel=Cancel_1,axios$1.CancelToken=CancelToken_1,axios$1.isCancel=isCancel$1,axios$1.all=function(e){return Promise.all(e)},axios$1.spread=spread,axios$1.isAxiosError=isAxiosError,axios$2.exports=axios$1,axios$2.exports.default=axios$1;var axios=axios$2.exports,Resource=function(){function e(t){_classCallCheck(this,e),this.client=t,this.variables={}}return _createClass(e,[{key:"id",value:function(e){return this.variables.id=e,this}}]),e}(),ContentResource=function(e){_inherits(i,e);var t,r,n=_createSuper(i);function i(e){return _classCallCheck(this,i),n.call(this,e)}return _createClass(i,[{key:"repository",value:function(e){return this.variables.repository=e,this}},{key:"person",value:function(e){return this.variables.person=e,this}},{key:"sortBy",value:function(e){return this.variables.sortBy=e,this}},{key:"sortUp",value:function(){return this.variables.sortDirection="ASC",this}},{key:"sortDown",value:function(){return this.variables.sortDirection="DESC",this}},{key:"pageSize",value:function(e){return this.variables.pageSize=e,this}},{key:"page",value:function(e){return this.variables.page=e,this}},{key:"type",value:function(e){return this.variables.type=e,this}},{key:"status",value:function(e){return this.variables.status=e,this}},{key:"published",value:function(){return this.variables.published=!0,this}},{key:"tags",value:function(e){return this.variables.tags=e,this}},{key:"fetch",value:(r=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t){var r,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.variables.id){e.next=6;break}return r={id:this.variables.id},e.next=4,this.client.query("query content($id: ID!) {\n                content(id: $id) {\n                    ".concat(t,"\n                }\n            }"),r);case 4:return n=e.sent,e.abrupt("return",{data:n.data.content});case 6:return i={repositoryId:this.variables.repository,personId:this.variables.person,sortBy:this.variables.sortBy,sortDirection:this.variables.sortDirection,pageSize:this.variables.pageSize,page:this.variables.page,type:this.variables.type,status:this.variables.status,published:this.variables.published,tags:this.variables.tags},e.next=9,this.client.query("query contents($repositoryId: ID, $personId: ID, $sortBy: String, $sortDirection: SortDirection, $pageSize: Int, $page: Int, $type: [String], $status: [String], $published: Boolean, $tags: [String]){\n            contents(repositoryId: $repositoryId, personId: $personId, sortBy: $sortBy, sortDirection: $sortDirection, pageSize: $pageSize, page: $page, type: $type, status: $status, published: $published, tags: $tags) {\n                ".concat(t,"\n            }\n        }"),i);case 9:return s=e.sent,e.abrupt("return",{data:s.data.contents});case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"delete",value:(t=_asyncToGenerator$9(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.variables.id){e.next=2;break}throw new Error("Content ID needs to be supplied before you can delete.");case 2:return t={contentId:this.variables.id},e.next=5,this.client.query("mutation deleteContent($contentId: ID!) {\n            deleteContent(contentId: $contentId) {\n                id\n                name\n            }\n        }",t);case 5:return r=e.sent,e.abrupt("return",{data:r.data.deleteContent});case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),i}(Resource),RepositoryResource=function(e){_inherits(n,e);var t,r=_createSuper(n);function n(e){return _classCallCheck(this,n),r.call(this,e)}return _createClass(n,[{key:"repository",value:function(e){return this.variables.repository=e,this}},{key:"sortBy",value:function(e){return this.variables.sortBy=e,this}},{key:"sortUp",value:function(){return this.variables.sortDirection="ASC",this}},{key:"sortDown",value:function(){return this.variables.sortDirection="DESC",this}},{key:"fetch",value:(t=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t){var r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.variables.id){e.next=5;break}return e.next=3,this.client.query("query repository($slug: String) {\n                repository(slug: $slug) {\n                    ".concat(t,"\n                }\n            }"),{slug:this.variables.id});case 3:return r=e.sent,e.abrupt("return",{data:r.data.repository});case 5:return n={sortBy:this.variables.sortBy,sortDirection:this.variables.sortDirection},e.next=8,this.client.query("query repositories($sortBy: String, $sortDirection: SortDirection) { \n            repositories(sortBy: $sortBy, sortDirection: $sortDirection) { \n                ".concat(t,"\n            }\n        }"),n);case 8:return i=e.sent,e.abrupt("return",{data:i.data.repositories});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),n}(Resource),ModelResource=function(e){_inherits(i,e);var t,r,n=_createSuper(i);function i(e){return _classCallCheck(this,i),n.call(this,e)}return _createClass(i,[{key:"repository",value:function(e){return this.variables.repository=e,this}},{key:"sortBy",value:function(e){return this.variables.sortBy=e,this}},{key:"sortUp",value:function(){return this.variables.sortDirection="ASC",this}},{key:"sortDown",value:function(){return this.variables.sortDirection="DESC",this}},{key:"pageSize",value:function(e){return this.variables.pageSize=e,this}},{key:"page",value:function(e){return this.variables.page=e,this}},{key:"status",value:function(e){return this.variables.status=e,this}},{key:"fetch",value:(r=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t){var r,n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.variables.id){e.next=6;break}return r={id:this.variables.id},e.next=4,this.client.query("query model($id: ID!) {\n                model(id: $id) {\n                    ".concat(t,"\n                }\n            }"),r);case 4:return n=e.sent,e.abrupt("return",{data:n.data.model});case 6:return i={repositoryId:this.variables.repository,sortBy:this.variables.sortBy,sortDirection:this.variables.sortDirection,pageSize:this.variables.pageSize,page:this.variables.page,status:this.variables.status},e.next=9,this.client.query("query models($repositoryId: ID!, $sortBy: String, $sortDirection: SortDirection, $pageSize: Int, $page: Int, $type: [String], $status: [String]) {\n            models(repositoryId: $repositoryId, sortBy: $sortBy, sortDirection: $sortDirection, pageSize: $pageSize, page: $page, type: $type, status: $status) {\n                ".concat(t,"\n            }\n        }"),i);case 9:return s=e.sent,e.abrupt("return",{data:s.data.models});case 11:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"delete",value:(t=_asyncToGenerator$9(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.variables.id){e.next=2;break}throw new Error("Model ID needs to be supplied before you can delete.");case 2:return t={modelId:this.variables.id},e.next=5,this.client.query("mutation deleteModel($modelId: ID!) {\n            deleteModel(modelId: $modelId) {\n                id\n                name\n            }\n        }",t);case 5:return r=e.sent,e.abrupt("return",{data:r.data.deleteModel});case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),i}(Resource),UnalikeError=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;_classCallCheck(this,r);var i="Unknown error";return e.body&&e.body.message?i=e.body.message:e.data&&e.data.message?i=e.data.message:e.data.errors&&e.data.errors.length>0&&e.data.errors[0].message&&(i=e.data.errors[0].message),(n=t.call(this,i)).status=e.status,n}return r}(_wrapNativeSuper(Error)),UnalikeQueryError=function(e){_inherits(r,e);var t=_createSuper(r);function r(e){var n;return _classCallCheck(this,r),(n=t.call(this,"Query error")).errors=e.data.errors,n.status=e.status,n}return r}(_wrapNativeSuper(Error)),Interceptors=function(){function e(){_classCallCheck(this,e),this.handlers=[]}return _createClass(e,[{key:"use",value:function(e){return this.handlers.push(e),this.handlers.length-1}},{key:"forEach",value:function(e){var t,r=_createForOfIteratorHelper(this.handlers);try{for(r.s();!(t=r.n()).done;){(0,t.value)(e)}}catch(e){r.e(e)}finally{r.f()}}}]),e}(),main={},QuillDeltaToHtmlConverter$2={},InsertOpsConverter$1={},DeltaInsertOp$1={},valueTypes={};Object.defineProperty(valueTypes,"__esModule",{value:!0});var NewLine="\n",ListType,ScriptType,DirectionType,AlignType,DataType,GroupType;valueTypes.NewLine=NewLine,function(e){e.Ordered="ordered",e.Bullet="bullet",e.Checked="checked",e.Unchecked="unchecked"}(ListType||(ListType={})),valueTypes.ListType=ListType,function(e){e.Sub="sub",e.Super="super"}(ScriptType||(ScriptType={})),valueTypes.ScriptType=ScriptType,function(e){e.Rtl="rtl"}(DirectionType||(DirectionType={})),valueTypes.DirectionType=DirectionType,function(e){e.Left="left",e.Center="center",e.Right="right",e.Justify="justify"}(AlignType||(AlignType={})),valueTypes.AlignType=AlignType,function(e){e.Image="image",e.Video="video",e.Formula="formula",e.Text="text"}(DataType||(DataType={})),valueTypes.DataType=DataType,function(e){e.Block="block",e.InlineGroup="inline-group",e.List="list",e.Video="video",e.Table="table"}(GroupType||(GroupType={})),valueTypes.GroupType=GroupType;var InsertData={};Object.defineProperty(InsertData,"__esModule",{value:!0});var InsertDataQuill=function(e,t){this.type=e,this.value=t};InsertData.InsertDataQuill=InsertDataQuill;var InsertDataCustom=function(e,t){this.type=e,this.value=t};InsertData.InsertDataCustom=InsertDataCustom;var lodash_isequal={exports:{}};!function(e,t){var r="__lodash_hash_undefined__",n=9007199254740991,i="[object Arguments]",s="[object Array]",o="[object Boolean]",a="[object Date]",u="[object Error]",c="[object Function]",l="[object Map]",p="[object Number]",h="[object Object]",d="[object Promise]",f="[object RegExp]",_="[object Set]",y="[object String]",m="[object Symbol]",v="[object WeakMap]",g="[object ArrayBuffer]",b="[object DataView]",$=/^\[object .+?Constructor\]$/,k=/^(?:0|[1-9]\d*)$/,T={};T["[object Float32Array]"]=T["[object Float64Array]"]=T["[object Int8Array]"]=T["[object Int16Array]"]=T["[object Int32Array]"]=T["[object Uint8Array]"]=T["[object Uint8ClampedArray]"]=T["[object Uint16Array]"]=T["[object Uint32Array]"]=!0,T[i]=T[s]=T[g]=T[o]=T[b]=T[a]=T[u]=T[c]=T[l]=T[p]=T[h]=T[f]=T[_]=T[y]=T[v]=!1;var C="object"==typeof commonjsGlobal&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal,w="object"==typeof self&&self&&self.Object===Object&&self,R=C||w||Function("return this")(),x=t&&!t.nodeType&&t,O=x&&e&&!e.nodeType&&e,S=O&&O.exports===x,E=S&&C.process,I=function(){try{return E&&E.binding&&E.binding("util")}catch(e){}}(),A=I&&I.isTypedArray;function L(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}function j(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}function D(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}var B,q,G,P=Array.prototype,z=Function.prototype,F=Object.prototype,N=R["__core-js_shared__"],U=z.toString,M=F.hasOwnProperty,H=(B=/[^.]+$/.exec(N&&N.keys&&N.keys.IE_PROTO||""))?"Symbol(src)_1."+B:"",V=F.toString,W=RegExp("^"+U.call(M).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),K=S?R.Buffer:void 0,Q=R.Symbol,Y=R.Uint8Array,J=F.propertyIsEnumerable,Z=P.splice,X=Q?Q.toStringTag:void 0,ee=Object.getOwnPropertySymbols,te=K?K.isBuffer:void 0,re=(q=Object.keys,G=Object,function(e){return q(G(e))}),ne=Ie(R,"DataView"),ie=Ie(R,"Map"),se=Ie(R,"Promise"),oe=Ie(R,"Set"),ae=Ie(R,"WeakMap"),ue=Ie(Object,"create"),ce=De(ne),le=De(ie),pe=De(se),he=De(oe),de=De(ae),fe=Q?Q.prototype:void 0,_e=fe?fe.valueOf:void 0;function ye(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function me(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ve(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function ge(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new ve;++t<r;)this.add(e[t])}function be(e){var t=this.__data__=new me(e);this.size=t.size}function $e(e,t){var r=Ge(e),n=!r&&qe(e),i=!r&&!n&&Pe(e),s=!r&&!n&&!i&&Me(e),o=r||n||i||s,a=o?function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}(e.length,String):[],u=a.length;for(var c in e)!t&&!M.call(e,c)||o&&("length"==c||i&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||je(c,u))||a.push(c);return a}function ke(e,t){for(var r=e.length;r--;)if(Be(e[r][0],t))return r;return-1}function Te(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":X&&X in Object(e)?function(e){var t=M.call(e,X),r=e[X];try{e[X]=void 0;var n=!0}catch(e){}var i=V.call(e);n&&(t?e[X]=r:delete e[X]);return i}(e):function(e){return V.call(e)}(e)}function Ce(e){return Ue(e)&&Te(e)==i}function we(e,t,r,n,c){return e===t||(null==e||null==t||!Ue(e)&&!Ue(t)?e!=e&&t!=t:function(e,t,r,n,c,d){var v=Ge(e),$=Ge(t),k=v?s:Le(e),T=$?s:Le(t),C=(k=k==i?h:k)==h,w=(T=T==i?h:T)==h,R=k==T;if(R&&Pe(e)){if(!Pe(t))return!1;v=!0,C=!1}if(R&&!C)return d||(d=new be),v||Me(e)?Oe(e,t,r,n,c,d):function(e,t,r,n,i,s,c){switch(r){case b:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case g:return!(e.byteLength!=t.byteLength||!s(new Y(e),new Y(t)));case o:case a:case p:return Be(+e,+t);case u:return e.name==t.name&&e.message==t.message;case f:case y:return e==t+"";case l:var h=j;case _:var d=1&n;if(h||(h=D),e.size!=t.size&&!d)return!1;var v=c.get(e);if(v)return v==t;n|=2,c.set(e,t);var $=Oe(h(e),h(t),n,i,s,c);return c.delete(e),$;case m:if(_e)return _e.call(e)==_e.call(t)}return!1}(e,t,k,r,n,c,d);if(!(1&r)){var x=C&&M.call(e,"__wrapped__"),O=w&&M.call(t,"__wrapped__");if(x||O){var S=x?e.value():e,E=O?t.value():t;return d||(d=new be),c(S,E,r,n,d)}}if(!R)return!1;return d||(d=new be),function(e,t,r,n,i,s){var o=1&r,a=Se(e),u=a.length,c=Se(t).length;if(u!=c&&!o)return!1;var l=u;for(;l--;){var p=a[l];if(!(o?p in t:M.call(t,p)))return!1}var h=s.get(e);if(h&&s.get(t))return h==t;var d=!0;s.set(e,t),s.set(t,e);var f=o;for(;++l<u;){var _=e[p=a[l]],y=t[p];if(n)var m=o?n(y,_,p,t,e,s):n(_,y,p,e,t,s);if(!(void 0===m?_===y||i(_,y,r,n,s):m)){d=!1;break}f||(f="constructor"==p)}if(d&&!f){var v=e.constructor,g=t.constructor;v==g||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof g&&g instanceof g||(d=!1)}return s.delete(e),s.delete(t),d}(e,t,r,n,c,d)}(e,t,r,n,we,c))}function Re(e){return!(!Ne(e)||function(e){return!!H&&H in e}(e))&&(ze(e)?W:$).test(De(e))}function xe(e){if(r=(t=e)&&t.constructor,n="function"==typeof r&&r.prototype||F,t!==n)return re(e);var t,r,n,i=[];for(var s in Object(e))M.call(e,s)&&"constructor"!=s&&i.push(s);return i}function Oe(e,t,r,n,i,s){var o=1&r,a=e.length,u=t.length;if(a!=u&&!(o&&u>a))return!1;var c=s.get(e);if(c&&s.get(t))return c==t;var l=-1,p=!0,h=2&r?new ge:void 0;for(s.set(e,t),s.set(t,e);++l<a;){var d=e[l],f=t[l];if(n)var _=o?n(f,d,l,t,e,s):n(d,f,l,e,t,s);if(void 0!==_){if(_)continue;p=!1;break}if(h){if(!L(t,(function(e,t){if(o=t,!h.has(o)&&(d===e||i(d,e,r,n,s)))return h.push(t);var o}))){p=!1;break}}else if(d!==f&&!i(d,f,r,n,s)){p=!1;break}}return s.delete(e),s.delete(t),p}function Se(e){return function(e,t,r){var n=t(e);return Ge(e)?n:function(e,t){for(var r=-1,n=t.length,i=e.length;++r<n;)e[i+r]=t[r];return e}(n,r(e))}(e,He,Ae)}function Ee(e,t){var r,n,i=e.__data__;return("string"==(n=typeof(r=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof t?"string":"hash"]:i.map}function Ie(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return Re(r)?r:void 0}ye.prototype.clear=function(){this.__data__=ue?ue(null):{},this.size=0},ye.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ye.prototype.get=function(e){var t=this.__data__;if(ue){var n=t[e];return n===r?void 0:n}return M.call(t,e)?t[e]:void 0},ye.prototype.has=function(e){var t=this.__data__;return ue?void 0!==t[e]:M.call(t,e)},ye.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ue&&void 0===t?r:t,this},me.prototype.clear=function(){this.__data__=[],this.size=0},me.prototype.delete=function(e){var t=this.__data__,r=ke(t,e);return!(r<0)&&(r==t.length-1?t.pop():Z.call(t,r,1),--this.size,!0)},me.prototype.get=function(e){var t=this.__data__,r=ke(t,e);return r<0?void 0:t[r][1]},me.prototype.has=function(e){return ke(this.__data__,e)>-1},me.prototype.set=function(e,t){var r=this.__data__,n=ke(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this},ve.prototype.clear=function(){this.size=0,this.__data__={hash:new ye,map:new(ie||me),string:new ye}},ve.prototype.delete=function(e){var t=Ee(this,e).delete(e);return this.size-=t?1:0,t},ve.prototype.get=function(e){return Ee(this,e).get(e)},ve.prototype.has=function(e){return Ee(this,e).has(e)},ve.prototype.set=function(e,t){var r=Ee(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this},ge.prototype.add=ge.prototype.push=function(e){return this.__data__.set(e,r),this},ge.prototype.has=function(e){return this.__data__.has(e)},be.prototype.clear=function(){this.__data__=new me,this.size=0},be.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},be.prototype.get=function(e){return this.__data__.get(e)},be.prototype.has=function(e){return this.__data__.has(e)},be.prototype.set=function(e,t){var r=this.__data__;if(r instanceof me){var n=r.__data__;if(!ie||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new ve(n)}return r.set(e,t),this.size=r.size,this};var Ae=ee?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,n=null==e?0:e.length,i=0,s=[];++r<n;){var o=e[r];t(o,r,e)&&(s[i++]=o)}return s}(ee(e),(function(t){return J.call(e,t)})))}:function(){return[]},Le=Te;function je(e,t){return!!(t=null==t?n:t)&&("number"==typeof e||k.test(e))&&e>-1&&e%1==0&&e<t}function De(e){if(null!=e){try{return U.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Be(e,t){return e===t||e!=e&&t!=t}(ne&&Le(new ne(new ArrayBuffer(1)))!=b||ie&&Le(new ie)!=l||se&&Le(se.resolve())!=d||oe&&Le(new oe)!=_||ae&&Le(new ae)!=v)&&(Le=function(e){var t=Te(e),r=t==h?e.constructor:void 0,n=r?De(r):"";if(n)switch(n){case ce:return b;case le:return l;case pe:return d;case he:return _;case de:return v}return t});var qe=Ce(function(){return arguments}())?Ce:function(e){return Ue(e)&&M.call(e,"callee")&&!J.call(e,"callee")},Ge=Array.isArray;var Pe=te||function(){return!1};function ze(e){if(!Ne(e))return!1;var t=Te(e);return t==c||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function Fe(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=n}function Ne(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Ue(e){return null!=e&&"object"==typeof e}var Me=A?function(e){return function(t){return e(t)}}(A):function(e){return Ue(e)&&Fe(e.length)&&!!T[Te(e)]};function He(e){return null!=(t=e)&&Fe(t.length)&&!ze(t)?$e(e):xe(e);var t}e.exports=function(e,t){return we(e,t)}}(lodash_isequal,lodash_isequal.exports);var __importDefault=commonjsGlobal&&commonjsGlobal.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(DeltaInsertOp$1,"__esModule",{value:!0});var value_types_1$5=valueTypes,InsertData_1$2=InsertData,lodash_isequal_1=__importDefault(lodash_isequal.exports),DeltaInsertOp=function(){function e(e,t){"string"==typeof e&&(e=new InsertData_1$2.InsertDataQuill(value_types_1$5.DataType.Text,e+"")),this.insert=e,this.attributes=t||{}}return e.createNewLineOp=function(){return new e(value_types_1$5.NewLine)},e.prototype.isContainerBlock=function(){return this.isBlockquote()||this.isList()||this.isTable()||this.isCodeBlock()||this.isHeader()||this.isBlockAttribute()||this.isCustomTextBlock()},e.prototype.isBlockAttribute=function(){var e=this.attributes;return!!(e.align||e.direction||e.indent)},e.prototype.isBlockquote=function(){return!!this.attributes.blockquote},e.prototype.isHeader=function(){return!!this.attributes.header},e.prototype.isTable=function(){return!!this.attributes.table},e.prototype.isSameHeaderAs=function(e){return e.attributes.header===this.attributes.header&&this.isHeader()},e.prototype.hasSameAdiAs=function(e){return this.attributes.align===e.attributes.align&&this.attributes.direction===e.attributes.direction&&this.attributes.indent===e.attributes.indent},e.prototype.hasSameIndentationAs=function(e){return this.attributes.indent===e.attributes.indent},e.prototype.hasSameAttr=function(e){return lodash_isequal_1.default(this.attributes,e.attributes)},e.prototype.hasHigherIndentThan=function(e){return(Number(this.attributes.indent)||0)>(Number(e.attributes.indent)||0)},e.prototype.isInline=function(){return!(this.isContainerBlock()||this.isVideo()||this.isCustomEmbedBlock())},e.prototype.isCodeBlock=function(){return!!this.attributes["code-block"]},e.prototype.hasSameLangAs=function(e){return this.attributes["code-block"]===e.attributes["code-block"]},e.prototype.isJustNewline=function(){return this.insert.value===value_types_1$5.NewLine},e.prototype.isList=function(){return this.isOrderedList()||this.isBulletList()||this.isCheckedList()||this.isUncheckedList()},e.prototype.isOrderedList=function(){return this.attributes.list===value_types_1$5.ListType.Ordered},e.prototype.isBulletList=function(){return this.attributes.list===value_types_1$5.ListType.Bullet},e.prototype.isCheckedList=function(){return this.attributes.list===value_types_1$5.ListType.Checked},e.prototype.isUncheckedList=function(){return this.attributes.list===value_types_1$5.ListType.Unchecked},e.prototype.isACheckList=function(){return this.attributes.list==value_types_1$5.ListType.Unchecked||this.attributes.list===value_types_1$5.ListType.Checked},e.prototype.isSameListAs=function(e){return!!e.attributes.list&&(this.attributes.list===e.attributes.list||e.isACheckList()&&this.isACheckList())},e.prototype.isSameTableRowAs=function(e){return!!e.isTable()&&this.isTable()&&this.attributes.table===e.attributes.table},e.prototype.isText=function(){return this.insert.type===value_types_1$5.DataType.Text},e.prototype.isImage=function(){return this.insert.type===value_types_1$5.DataType.Image},e.prototype.isFormula=function(){return this.insert.type===value_types_1$5.DataType.Formula},e.prototype.isVideo=function(){return this.insert.type===value_types_1$5.DataType.Video},e.prototype.isLink=function(){return this.isText()&&!!this.attributes.link},e.prototype.isCustomEmbed=function(){return this.insert instanceof InsertData_1$2.InsertDataCustom},e.prototype.isCustomEmbedBlock=function(){return this.isCustomEmbed()&&!!this.attributes.renderAsBlock},e.prototype.isCustomTextBlock=function(){return this.isText()&&!!this.attributes.renderAsBlock},e.prototype.isMentions=function(){return this.isText()&&!!this.attributes.mentions},e}();DeltaInsertOp$1.DeltaInsertOp=DeltaInsertOp;var OpAttributeSanitizer$1={},MentionSanitizer$1={};Object.defineProperty(MentionSanitizer$1,"__esModule",{value:!0});var OpAttributeSanitizer_1$1=OpAttributeSanitizer$1,MentionSanitizer=function(){function e(){}return e.sanitize=function(t,r){var n={};return t&&"object"==typeof t?(t.class&&e.IsValidClass(t.class)&&(n.class=t.class),t.id&&e.IsValidId(t.id)&&(n.id=t.id),e.IsValidTarget(t.target+"")&&(n.target=t.target),t.avatar&&(n.avatar=OpAttributeSanitizer_1$1.OpAttributeSanitizer.sanitizeLinkUsingOptions(t.avatar+"",r)),t["end-point"]&&(n["end-point"]=OpAttributeSanitizer_1$1.OpAttributeSanitizer.sanitizeLinkUsingOptions(t["end-point"]+"",r)),t.slug&&(n.slug=t.slug+""),n):n},e.IsValidClass=function(e){return!!e.match(/^[a-zA-Z0-9_\-]{1,500}$/i)},e.IsValidId=function(e){return!!e.match(/^[a-zA-Z0-9_\-\:\.]{1,500}$/i)},e.IsValidTarget=function(e){return["_self","_blank","_parent","_top"].indexOf(e)>-1},e}();MentionSanitizer$1.MentionSanitizer=MentionSanitizer;var url$1={};function sanitize(e){var t=e;t=t.replace(/^\s*/gm,"");return/^((https?|s?ftp|file|blob|mailto|tel):|#|\/|data:image\/)/.test(t)?t:"unsafe:"+t}Object.defineProperty(url$1,"__esModule",{value:!0}),url$1.sanitize=sanitize;var funcsHtml={},EncodeTarget;function makeStartTag(e,t){if(void 0===t&&(t=void 0),!e)return"";var r="";t&&(r=[].concat(t).map((function(e){return e.key+(e.value?'="'+e.value+'"':"")})).join(" "));var n=">";return"img"!==e&&"br"!==e||(n="/>"),r?"<"+e+" "+r+n:"<"+e+n}function makeEndTag(e){return void 0===e&&(e=""),e&&"</"+e+">"||""}function decodeHtml(e){return encodeMappings(EncodeTarget.Html).reduce(decodeMapping,e)}function encodeHtml(e,t){return void 0===t&&(t=!0),t&&(e=decodeHtml(e)),encodeMappings(EncodeTarget.Html).reduce(encodeMapping,e)}function encodeLink(e){var t=encodeMappings(EncodeTarget.Url),r=t.reduce(decodeMapping,e);return t.reduce(encodeMapping,r)}function encodeMappings(e){var t=[["&","&amp;"],["<","&lt;"],[">","&gt;"],['"',"&quot;"],["'","&#x27;"],["\\/","&#x2F;"],["\\(","&#40;"],["\\)","&#41;"]];return e===EncodeTarget.Html?t.filter((function(e){var t=e[0];return e[1],-1===t.indexOf("(")&&-1===t.indexOf(")")})):t.filter((function(e){var t=e[0];return e[1],-1===t.indexOf("/")}))}function encodeMapping(e,t){return e.replace(new RegExp(t[0],"g"),t[1])}function decodeMapping(e,t){return e.replace(new RegExp(t[1],"g"),t[0].replace("\\",""))}Object.defineProperty(funcsHtml,"__esModule",{value:!0}),function(e){e[e.Html=0]="Html",e[e.Url=1]="Url"}(EncodeTarget||(EncodeTarget={})),funcsHtml.makeStartTag=makeStartTag,funcsHtml.makeEndTag=makeEndTag,funcsHtml.decodeHtml=decodeHtml,funcsHtml.encodeHtml=encodeHtml,funcsHtml.encodeLink=encodeLink;var array={};function preferSecond(e){return 0===e.length?null:e.length>=2?e[1]:e[0]}function flatten(e){return e.reduce((function(e,t){return e.concat(Array.isArray(t)?flatten(t):t)}),[])}function find(e,t){if(Array.prototype.find)return Array.prototype.find.call(e,t);for(var r=0;r<e.length;r++)if(t(e[r]))return e[r]}function groupConsecutiveElementsWhile(e,t){for(var r,n=[],i=0;i<e.length;i++)r=e[i],i>0&&t(r,e[i-1])?n[n.length-1].push(r):n.push([r]);return n.map((function(e){return 1===e.length?e[0]:e}))}function sliceFromReverseWhile(e,t,r){for(var n={elements:[],sliceStartsAt:-1},i=t;i>=0&&r(e[i]);i--)n.sliceStartsAt=i,n.elements.unshift(e[i]);return n}function intersperse(e,t){return e.reduce((function(r,n,i){return r.push(n),i<e.length-1&&r.push(t),r}),[])}Object.defineProperty(array,"__esModule",{value:!0}),array.preferSecond=preferSecond,array.flatten=flatten,array.find=find,array.groupConsecutiveElementsWhile=groupConsecutiveElementsWhile,array.sliceFromReverseWhile=sliceFromReverseWhile,array.intersperse=intersperse;var __importStar$2=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(OpAttributeSanitizer$1,"__esModule",{value:!0});var value_types_1$4=valueTypes,MentionSanitizer_1=MentionSanitizer$1,url=__importStar$2(url$1),funcs_html_1$1=funcsHtml,array_1$3=array,OpAttributeSanitizer=function(){function e(){}return e.sanitize=function(t,r){var n={};if(!t||"object"!=typeof t)return n;var i=["bold","italic","underline","strike","code","blockquote","code-block","renderAsBlock"],s=["background","color"],o=t.font,a=t.size,u=t.link,c=t.script,l=t.list,p=t.header,h=t.align,d=t.direction,f=t.indent,_=t.mentions,y=t.mention,m=t.width,v=t.target,g=t.rel,b=t["code-block"],$=i.concat(s,["font","size","link","script","list","header","align","direction","indent","mentions","mention","width","target","rel","code-block"]);if(i.forEach((function(e){var r=t[e];r&&(n[e]=!!r)})),s.forEach((function(r){var i=t[r];i&&(e.IsValidHexColor(i+"")||e.IsValidColorLiteral(i+"")||e.IsValidRGBColor(i+""))&&(n[r]=i)})),o&&e.IsValidFontName(o+"")&&(n.font=o),a&&e.IsValidSize(a+"")&&(n.size=a),m&&e.IsValidWidth(m+"")&&(n.width=m),u&&(n.link=e.sanitizeLinkUsingOptions(u+"",r)),v&&e.isValidTarget(v)&&(n.target=v),g&&e.IsValidRel(g)&&(n.rel=g),b&&(e.IsValidLang(b)?n["code-block"]=b:n["code-block"]=!!b),c!==value_types_1$4.ScriptType.Sub&&value_types_1$4.ScriptType.Super!==c||(n.script=c),l!==value_types_1$4.ListType.Bullet&&l!==value_types_1$4.ListType.Ordered&&l!==value_types_1$4.ListType.Checked&&l!==value_types_1$4.ListType.Unchecked||(n.list=l),Number(p)&&(n.header=Math.min(Number(p),6)),array_1$3.find([value_types_1$4.AlignType.Center,value_types_1$4.AlignType.Right,value_types_1$4.AlignType.Justify,value_types_1$4.AlignType.Left],(function(e){return e===h}))&&(n.align=h),d===value_types_1$4.DirectionType.Rtl&&(n.direction=d),f&&Number(f)&&(n.indent=Math.min(Number(f),30)),_&&y){var k=MentionSanitizer_1.MentionSanitizer.sanitize(y,r);Object.keys(k).length>0&&(n.mentions=!!_,n.mention=y)}return Object.keys(t).reduce((function(e,r){return-1===$.indexOf(r)&&(e[r]=t[r]),e}),n)},e.sanitizeLinkUsingOptions=function(e,t){var r=function(){};t&&"function"==typeof t.urlSanitizer&&(r=t.urlSanitizer);var n=r(e);return"string"==typeof n?n:funcs_html_1$1.encodeLink(url.sanitize(e))},e.IsValidHexColor=function(e){return!!e.match(/^#([0-9A-F]{6}|[0-9A-F]{3})$/i)},e.IsValidColorLiteral=function(e){return!!e.match(/^[a-z]{1,50}$/i)},e.IsValidRGBColor=function(e){return!!e.match(/^rgb\(((0|25[0-5]|2[0-4]\d|1\d\d|0?\d?\d),\s*){2}(0|25[0-5]|2[0-4]\d|1\d\d|0?\d?\d)\)$/i)},e.IsValidFontName=function(e){return!!e.match(/^[a-z\s0-9\- ]{1,30}$/i)},e.IsValidSize=function(e){return!!e.match(/^[a-z0-9\-]{1,20}$/i)},e.IsValidWidth=function(e){return!!e.match(/^[0-9]*(px|em|%)?$/)},e.isValidTarget=function(e){return!!e.match(/^[_a-zA-Z0-9\-]{1,50}$/)},e.IsValidRel=function(e){return!!e.match(/^[a-zA-Z\s\-]{1,250}$/i)},e.IsValidLang=function(e){return"boolean"==typeof e||!!e.match(/^[a-zA-Z\s\-\\\/\+]{1,50}$/i)},e}();OpAttributeSanitizer$1.OpAttributeSanitizer=OpAttributeSanitizer;var InsertOpDenormalizer$1={},string={};function tokenizeWithNewLines(e){var t="\n";if(e===t)return[e];var r=e.split(t);if(1===r.length)return r;var n=r.length-1;return r.reduce((function(e,r,i){return i!==n?""!==r?e=e.concat(r,t):e.push(t):""!==r&&e.push(r),e}),[])}Object.defineProperty(string,"__esModule",{value:!0}),string.tokenizeWithNewLines=tokenizeWithNewLines;var object={};function assign(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=0;i<t.length;i++){var s=t[i];if(null!=s)for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&(n[o]=s[o])}return n}Object.defineProperty(object,"__esModule",{value:!0}),object.assign=assign;var __importStar$1=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(InsertOpDenormalizer$1,"__esModule",{value:!0});var value_types_1$3=valueTypes,str=__importStar$1(string),obj$1=__importStar$1(object),InsertOpDenormalizer=function(){function e(){}return e.denormalize=function(e){if(!e||"object"!=typeof e)return[];if("object"==typeof e.insert||e.insert===value_types_1$3.NewLine)return[e];var t=str.tokenizeWithNewLines(e.insert+"");if(1===t.length)return[e];var r=obj$1.assign({},e,{insert:value_types_1$3.NewLine});return t.map((function(t){return t===value_types_1$3.NewLine?r:obj$1.assign({},e,{insert:t})}))},e}();InsertOpDenormalizer$1.InsertOpDenormalizer=InsertOpDenormalizer,Object.defineProperty(InsertOpsConverter$1,"__esModule",{value:!0});var DeltaInsertOp_1$2=DeltaInsertOp$1,value_types_1$2=valueTypes,InsertData_1$1=InsertData,OpAttributeSanitizer_1=OpAttributeSanitizer$1,InsertOpDenormalizer_1=InsertOpDenormalizer$1,InsertOpsConverter=function(){function e(){}return e.convert=function(t,r){if(!Array.isArray(t))return[];for(var n,i,s=[],o=0,a=[].concat.apply([],t.map(InsertOpDenormalizer_1.InsertOpDenormalizer.denormalize));o<a.length;o++){var u=a[o];u.insert&&((n=e.convertInsertVal(u.insert,r))&&(i=OpAttributeSanitizer_1.OpAttributeSanitizer.sanitize(u.attributes,r),s.push(new DeltaInsertOp_1$2.DeltaInsertOp(n,i))))}return s},e.convertInsertVal=function(e,t){if("string"==typeof e)return new InsertData_1$1.InsertDataQuill(value_types_1$2.DataType.Text,e);if(!e||"object"!=typeof e)return null;var r=Object.keys(e);return r.length?value_types_1$2.DataType.Image in e?new InsertData_1$1.InsertDataQuill(value_types_1$2.DataType.Image,OpAttributeSanitizer_1.OpAttributeSanitizer.sanitizeLinkUsingOptions(e[value_types_1$2.DataType.Image]+"",t)):value_types_1$2.DataType.Video in e?new InsertData_1$1.InsertDataQuill(value_types_1$2.DataType.Video,OpAttributeSanitizer_1.OpAttributeSanitizer.sanitizeLinkUsingOptions(e[value_types_1$2.DataType.Video]+"",t)):value_types_1$2.DataType.Formula in e?new InsertData_1$1.InsertDataQuill(value_types_1$2.DataType.Formula,e[value_types_1$2.DataType.Formula]):new InsertData_1$1.InsertDataCustom(r[0],e[r[0]]):null},e}();InsertOpsConverter$1.InsertOpsConverter=InsertOpsConverter;var OpToHtmlConverter={};!function(e){var t=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(e,"__esModule",{value:!0});var r=funcsHtml,n=valueTypes,i=t(object),s=t(array),o=OpAttributeSanitizer$1,a={serif:"font-family: Georgia, Times New Roman, serif",monospace:"font-family: Monaco, Courier New, monospace"};e.DEFAULT_INLINE_STYLES={font:function(e){return a[e]||"font-family:"+e},size:{small:"font-size: 0.75em",large:"font-size: 1.5em",huge:"font-size: 2.5em"},indent:function(e,t){var r=3*parseInt(e,10);return"padding-"+("rtl"===t.attributes.direction?"right":"left")+":"+r+"em"},direction:function(e,t){return"rtl"===e?"direction:rtl"+(t.attributes.align?"":"; text-align:inherit"):void 0}};var u=function(){function t(e,t){this.op=e,this.options=i.assign({},{classPrefix:"ql",inlineStyles:void 0,encodeHtml:!0,listItemTag:"li",paragraphTag:"p"},t)}return t.prototype.prefixClass=function(e){return this.options.classPrefix?this.options.classPrefix+"-"+e:e+""},t.prototype.getHtml=function(){var e=this.getHtmlParts();return e.openingTag+e.content+e.closingTag},t.prototype.getHtmlParts=function(){var e=this;if(this.op.isJustNewline()&&!this.op.isContainerBlock())return{openingTag:"",closingTag:"",content:n.NewLine};var t=this.getTags(),i=this.getTagAttributes();!t.length&&i.length&&t.push("span");for(var s=[],o=[],a=function(t){return"img"===t&&!!e.op.attributes.link},u=0,c=t;u<c.length;u++){var l=c[u];a(l)&&s.push(r.makeStartTag("a",this.getLinkAttrs())),s.push(r.makeStartTag(l,i)),o.push("img"===l?"":r.makeEndTag(l)),a(l)&&o.push(r.makeEndTag("a")),i=[]}return o.reverse(),{openingTag:s.join(""),content:this.getContent(),closingTag:o.join("")}},t.prototype.getContent=function(){if(this.op.isContainerBlock())return"";if(this.op.isMentions())return this.op.insert.value;var e=this.op.isFormula()||this.op.isText()?this.op.insert.value:"";return this.options.encodeHtml&&r.encodeHtml(e)||e},t.prototype.getCssClasses=function(){var e=this.op.attributes;if(this.options.inlineStyles)return[];var t=["indent","align","direction","font","size"];return this.options.allowBackgroundClasses&&t.push("background"),(this.getCustomCssClasses()||[]).concat(t.filter((function(t){return!!e[t]})).filter((function(t){return"background"!==t||o.OpAttributeSanitizer.IsValidColorLiteral(e[t])})).map((function(t){return t+"-"+e[t]})).concat(this.op.isFormula()?"formula":[]).concat(this.op.isVideo()?"video":[]).concat(this.op.isImage()?"image":[]).map(this.prefixClass.bind(this)))},t.prototype.getCssStyles=function(){var t=this,r=this.op.attributes,n=[["color"]];return!this.options.inlineStyles&&this.options.allowBackgroundClasses||n.push(["background","background-color"]),this.options.inlineStyles&&(n=n.concat([["indent"],["align","text-align"],["direction"],["font","font-family"],["size"]])),(this.getCustomCssStyles()||[]).concat(n.filter((function(e){return!!r[e[0]]})).map((function(n){var i=n[0],o=r[i],a=t.options.inlineStyles&&t.options.inlineStyles[i]||e.DEFAULT_INLINE_STYLES[i];return"object"==typeof a?a[o]:"function"==typeof a?a(o,t.op):s.preferSecond(n)+":"+o}))).filter((function(e){return void 0!==e}))},t.prototype.getTagAttributes=function(){if(this.op.attributes.code&&!this.op.isLink())return[];var e=this.makeAttr.bind(this),t=this.getCustomTagAttributes(),r=t?Object.keys(this.getCustomTagAttributes()).map((function(r){return e(r,t[r])})):[],n=this.getCssClasses(),i=n.length?r.concat([e("class",n.join(" "))]):r;if(this.op.isImage())return this.op.attributes.width&&(i=i.concat(e("width",this.op.attributes.width))),i.concat(e("src",this.op.insert.value));if(this.op.isACheckList())return i.concat(e("data-checked",this.op.isCheckedList()?"true":"false"));if(this.op.isFormula())return i;if(this.op.isVideo())return i.concat(e("frameborder","0"),e("allowfullscreen","true"),e("src",this.op.insert.value));if(this.op.isMentions()){var s=this.op.attributes.mention;return s.class&&(i=i.concat(e("class",s.class))),i=s["end-point"]&&s.slug?i.concat(e("href",s["end-point"]+"/"+s.slug)):i.concat(e("href","about:blank")),s.target&&(i=i.concat(e("target",s.target))),i}var o=this.getCssStyles();return o.length&&i.push(e("style",o.join(";"))),this.op.isCodeBlock()&&"string"==typeof this.op.attributes["code-block"]?i.concat(e("data-language",this.op.attributes["code-block"])):(this.op.isContainerBlock()||this.op.isLink()&&(i=i.concat(this.getLinkAttrs())),i)},t.prototype.makeAttr=function(e,t){return{key:e,value:t}},t.prototype.getLinkAttrs=function(){var e=o.OpAttributeSanitizer.isValidTarget(this.options.linkTarget||"")?this.options.linkTarget:void 0,t=o.OpAttributeSanitizer.IsValidRel(this.options.linkRel||"")?this.options.linkRel:void 0,r=this.op.attributes.target||e,n=this.op.attributes.rel||t;return[].concat(this.makeAttr("href",this.op.attributes.link)).concat(r?this.makeAttr("target",r):[]).concat(n?this.makeAttr("rel",n):[])},t.prototype.getCustomTag=function(e){if(this.options.customTag&&"function"==typeof this.options.customTag)return this.options.customTag.apply(null,[e,this.op])},t.prototype.getCustomTagAttributes=function(){if(this.options.customTagAttributes&&"function"==typeof this.options.customTagAttributes)return this.options.customTagAttributes.apply(null,[this.op])},t.prototype.getCustomCssClasses=function(){if(this.options.customCssClasses&&"function"==typeof this.options.customCssClasses){var e=this.options.customCssClasses.apply(null,[this.op]);if(e)return Array.isArray(e)?e:[e]}},t.prototype.getCustomCssStyles=function(){if(this.options.customCssStyles&&"function"==typeof this.options.customCssStyles){var e=this.options.customCssStyles.apply(null,[this.op]);if(e)return Array.isArray(e)?e:[e]}},t.prototype.getTags=function(){var e=this,t=this.op.attributes;if(!this.op.isText())return[this.op.isVideo()?"iframe":this.op.isImage()?"img":"span"];for(var r=this.options.paragraphTag||"p",i=0,o=[["blockquote"],["code-block","pre"],["list",this.options.listItemTag],["header"],["align",r],["direction",r],["indent",r]];i<o.length;i++){var a,u=o[i],c=u[0];if(t[c])return(a=this.getCustomTag(c))?[a]:"header"===c?["h"+t[c]]:[s.preferSecond(u)]}if(this.op.isCustomTextBlock())return(a=this.getCustomTag("renderAsBlock"))?[a]:[r];var l=Object.keys(t).reduce((function(t,r){var n=e.getCustomTag(r);return n&&(t[r]=n),t}),{}),p=[["link","a"],["mentions","a"],["script"],["bold","strong"],["italic","em"],["strike","s"],["underline","u"],["code"]];return p.filter((function(e){return!!t[e[0]]})).concat(Object.keys(l).filter((function(e){return!p.some((function(t){return t[0]==e}))})).map((function(e){return[e,l[e]]}))).map((function(e){return l[e[0]]?l[e[0]]:"script"===e[0]?t[e[0]]===n.ScriptType.Sub?"sub":"sup":s.preferSecond(e)}))},t}();e.OpToHtmlConverter=u}(OpToHtmlConverter);var Grouper$1={},groupTypes={},__extends=commonjsGlobal&&commonjsGlobal.__extends||(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])},function(e,t){function r(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),extendStatics;Object.defineProperty(groupTypes,"__esModule",{value:!0});var InlineGroup=function(e){this.ops=e};groupTypes.InlineGroup=InlineGroup;var SingleItem=function(e){this.op=e},VideoItem=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(SingleItem);groupTypes.VideoItem=VideoItem;var BlotBlock=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(SingleItem);groupTypes.BlotBlock=BlotBlock;var BlockGroup=function(e,t){this.op=e,this.ops=t};groupTypes.BlockGroup=BlockGroup;var ListGroup=function(e){this.items=e};groupTypes.ListGroup=ListGroup;var ListItem=function(e,t){void 0===t&&(t=null),this.item=e,this.innerList=t};groupTypes.ListItem=ListItem;var TableGroup=function(e){this.rows=e};groupTypes.TableGroup=TableGroup;var TableRow=function(e){this.cells=e};groupTypes.TableRow=TableRow;var TableCell=function(e){this.item=e};groupTypes.TableCell=TableCell,Object.defineProperty(Grouper$1,"__esModule",{value:!0});var DeltaInsertOp_1$1=DeltaInsertOp$1,array_1$2=array,group_types_1$4=groupTypes,Grouper=function(){function e(){}return e.pairOpsWithTheirBlock=function(e){for(var t,r=[],n=function(e){return!(e.isJustNewline()||e.isCustomEmbedBlock()||e.isVideo()||e.isContainerBlock())},i=function(e){return e.isInline()},s=e.length-1;s>=0;s--){var o=e[s];o.isVideo()?r.push(new group_types_1$4.VideoItem(o)):o.isCustomEmbedBlock()?r.push(new group_types_1$4.BlotBlock(o)):o.isContainerBlock()?(t=array_1$2.sliceFromReverseWhile(e,s-1,n),r.push(new group_types_1$4.BlockGroup(o,t.elements)),s=t.sliceStartsAt>-1?t.sliceStartsAt:s):(t=array_1$2.sliceFromReverseWhile(e,s-1,i),r.push(new group_types_1$4.InlineGroup(t.elements.concat(o))),s=t.sliceStartsAt>-1?t.sliceStartsAt:s)}return r.reverse(),r},e.groupConsecutiveSameStyleBlocks=function(t,r){return void 0===r&&(r={header:!0,codeBlocks:!0,blockquotes:!0,customBlocks:!0}),array_1$2.groupConsecutiveElementsWhile(t,(function(t,n){return t instanceof group_types_1$4.BlockGroup&&n instanceof group_types_1$4.BlockGroup&&(r.codeBlocks&&e.areBothCodeblocksWithSameLang(t,n)||r.blockquotes&&e.areBothBlockquotesWithSameAdi(t,n)||r.header&&e.areBothSameHeadersWithSameAdi(t,n)||r.customBlocks&&e.areBothCustomBlockWithSameAttr(t,n))}))},e.reduceConsecutiveSameStyleBlocksToOne=function(e){var t=DeltaInsertOp_1$1.DeltaInsertOp.createNewLineOp();return e.map((function(e){if(!Array.isArray(e))return e instanceof group_types_1$4.BlockGroup&&!e.ops.length&&e.ops.push(t),e;var r=e.length-1;return e[0].ops=array_1$2.flatten(e.map((function(e,n){return e.ops.length?e.ops.concat(n<r?[t]:[]):[t]}))),e[0]}))},e.areBothCodeblocksWithSameLang=function(e,t){return e.op.isCodeBlock()&&t.op.isCodeBlock()&&e.op.hasSameLangAs(t.op)},e.areBothSameHeadersWithSameAdi=function(e,t){return e.op.isSameHeaderAs(t.op)&&e.op.hasSameAdiAs(t.op)},e.areBothBlockquotesWithSameAdi=function(e,t){return e.op.isBlockquote()&&t.op.isBlockquote()&&e.op.hasSameAdiAs(t.op)},e.areBothCustomBlockWithSameAttr=function(e,t){return e.op.isCustomTextBlock()&&t.op.isCustomTextBlock()&&e.op.hasSameAttr(t.op)},e}();Grouper$1.Grouper=Grouper;var ListNester$1={};Object.defineProperty(ListNester$1,"__esModule",{value:!0});var group_types_1$3=groupTypes,array_1$1=array,ListNester=function(){function e(){}return e.prototype.nest=function(e){var t=this,r=this.convertListBlocksToListGroups(e),n=this.groupConsecutiveListGroups(r),i=array_1$1.flatten(n.map((function(e){return Array.isArray(e)?t.nestListSection(e):e})));return array_1$1.groupConsecutiveElementsWhile(i,(function(e,t){return e instanceof group_types_1$3.ListGroup&&t instanceof group_types_1$3.ListGroup&&e.items[0].item.op.isSameListAs(t.items[0].item.op)})).map((function(e){if(!Array.isArray(e))return e;var t=e.map((function(e){return e.items}));return new group_types_1$3.ListGroup(array_1$1.flatten(t))}))},e.prototype.convertListBlocksToListGroups=function(e){return array_1$1.groupConsecutiveElementsWhile(e,(function(e,t){return e instanceof group_types_1$3.BlockGroup&&t instanceof group_types_1$3.BlockGroup&&e.op.isList()&&t.op.isList()&&e.op.isSameListAs(t.op)&&e.op.hasSameIndentationAs(t.op)})).map((function(e){return Array.isArray(e)?new group_types_1$3.ListGroup(e.map((function(e){return new group_types_1$3.ListItem(e)}))):e instanceof group_types_1$3.BlockGroup&&e.op.isList()?new group_types_1$3.ListGroup([new group_types_1$3.ListItem(e)]):e}))},e.prototype.groupConsecutiveListGroups=function(e){return array_1$1.groupConsecutiveElementsWhile(e,(function(e,t){return e instanceof group_types_1$3.ListGroup&&t instanceof group_types_1$3.ListGroup}))},e.prototype.nestListSection=function(e){var t=this,r=this.groupByIndent(e);return Object.keys(r).map(Number).sort().reverse().forEach((function(n){r[n].forEach((function(r){var n=e.indexOf(r);t.placeUnderParent(r,e.slice(0,n))&&e.splice(n,1)}))})),e},e.prototype.groupByIndent=function(e){return e.reduce((function(e,t){var r=t.items[0].item.op.attributes.indent;return r&&(e[r]=e[r]||[],e[r].push(t)),e}),{})},e.prototype.placeUnderParent=function(e,t){for(var r=t.length-1;r>=0;r--){var n=t[r];if(e.items[0].item.op.hasHigherIndentThan(n.items[0].item.op)){var i=n.items[n.items.length-1];return i.innerList?i.innerList.items=i.innerList.items.concat(e.items):i.innerList=e,!0}}return!1},e}();ListNester$1.ListNester=ListNester;var TableGrouper$1={};Object.defineProperty(TableGrouper$1,"__esModule",{value:!0});var group_types_1$2=groupTypes,array_1=array,TableGrouper=function(){function e(){}return e.prototype.group=function(e){return this.convertTableBlocksToTableGroups(e)},e.prototype.convertTableBlocksToTableGroups=function(e){var t=this;return array_1.groupConsecutiveElementsWhile(e,(function(e,t){return e instanceof group_types_1$2.BlockGroup&&t instanceof group_types_1$2.BlockGroup&&e.op.isTable()&&t.op.isTable()})).map((function(e){return Array.isArray(e)?new group_types_1$2.TableGroup(t.convertTableBlocksToTableRows(e)):e instanceof group_types_1$2.BlockGroup&&e.op.isTable()?new group_types_1$2.TableGroup([new group_types_1$2.TableRow([new group_types_1$2.TableCell(e)])]):e}))},e.prototype.convertTableBlocksToTableRows=function(e){return array_1.groupConsecutiveElementsWhile(e,(function(e,t){return e instanceof group_types_1$2.BlockGroup&&t instanceof group_types_1$2.BlockGroup&&e.op.isTable()&&t.op.isTable()&&e.op.isSameTableRowAs(t.op)})).map((function(e){return new group_types_1$2.TableRow(Array.isArray(e)?e.map((function(e){return new group_types_1$2.TableCell(e)})):[new group_types_1$2.TableCell(e)])}))},e}();TableGrouper$1.TableGrouper=TableGrouper;var __importStar=commonjsGlobal&&commonjsGlobal.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t};Object.defineProperty(QuillDeltaToHtmlConverter$2,"__esModule",{value:!0});var InsertOpsConverter_1=InsertOpsConverter$1,OpToHtmlConverter_1$1=OpToHtmlConverter,Grouper_1=Grouper$1,group_types_1$1=groupTypes,ListNester_1=ListNester$1,funcs_html_1=funcsHtml,obj=__importStar(object),value_types_1$1=valueTypes,TableGrouper_1=TableGrouper$1,BrTag="<br/>",QuillDeltaToHtmlConverter$1=function(){function e(e,t){var r;this.rawDeltaOps=[],this.callbacks={},this.options=obj.assign({paragraphTag:"p",encodeHtml:!0,classPrefix:"ql",inlineStyles:!1,multiLineBlockquote:!0,multiLineHeader:!0,multiLineCodeblock:!0,multiLineParagraph:!0,multiLineCustomBlock:!0,allowBackgroundClasses:!1,linkTarget:"_blank"},t,{orderedListTag:"ol",bulletListTag:"ul",listItemTag:"li"}),r=this.options.inlineStyles?"object"==typeof this.options.inlineStyles?this.options.inlineStyles:{}:void 0,this.converterOptions={encodeHtml:this.options.encodeHtml,classPrefix:this.options.classPrefix,inlineStyles:r,listItemTag:this.options.listItemTag,paragraphTag:this.options.paragraphTag,linkRel:this.options.linkRel,linkTarget:this.options.linkTarget,allowBackgroundClasses:this.options.allowBackgroundClasses,customTag:this.options.customTag,customTagAttributes:this.options.customTagAttributes,customCssClasses:this.options.customCssClasses,customCssStyles:this.options.customCssStyles},this.rawDeltaOps=e}return e.prototype._getListTag=function(e){return e.isOrderedList()?this.options.orderedListTag+"":e.isBulletList()||e.isCheckedList()||e.isUncheckedList()?this.options.bulletListTag+"":""},e.prototype.getGroupedOps=function(){var e=InsertOpsConverter_1.InsertOpsConverter.convert(this.rawDeltaOps,this.options),t=Grouper_1.Grouper.pairOpsWithTheirBlock(e),r=Grouper_1.Grouper.groupConsecutiveSameStyleBlocks(t,{blockquotes:!!this.options.multiLineBlockquote,header:!!this.options.multiLineHeader,codeBlocks:!!this.options.multiLineCodeblock,customBlocks:!!this.options.multiLineCustomBlock}),n=Grouper_1.Grouper.reduceConsecutiveSameStyleBlocksToOne(r);return n=(new TableGrouper_1.TableGrouper).group(n),(new ListNester_1.ListNester).nest(n)},e.prototype.convert=function(){var e=this;return this.getGroupedOps().map((function(t){if(t instanceof group_types_1$1.ListGroup)return e._renderWithCallbacks(value_types_1$1.GroupType.List,t,(function(){return e._renderList(t)}));if(t instanceof group_types_1$1.TableGroup)return e._renderWithCallbacks(value_types_1$1.GroupType.Table,t,(function(){return e._renderTable(t)}));if(t instanceof group_types_1$1.BlockGroup){var r=t;return e._renderWithCallbacks(value_types_1$1.GroupType.Block,t,(function(){return e._renderBlock(r.op,r.ops)}))}return t instanceof group_types_1$1.BlotBlock?e._renderCustom(t.op,null):t instanceof group_types_1$1.VideoItem?e._renderWithCallbacks(value_types_1$1.GroupType.Video,t,(function(){var r=t;return new OpToHtmlConverter_1$1.OpToHtmlConverter(r.op,e.converterOptions).getHtml()})):e._renderWithCallbacks(value_types_1$1.GroupType.InlineGroup,t,(function(){return e._renderInlines(t.ops,!0)}))})).join("")},e.prototype._renderWithCallbacks=function(e,t,r){var n="",i=this.callbacks.beforeRender_cb;(n="function"==typeof i?i.apply(null,[e,t]):"")||(n=r());var s=this.callbacks.afterRender_cb;return n="function"==typeof s?s.apply(null,[e,n]):n},e.prototype._renderList=function(e){var t=this,r=e.items[0];return funcs_html_1.makeStartTag(this._getListTag(r.item.op))+e.items.map((function(e){return t._renderListItem(e)})).join("")+funcs_html_1.makeEndTag(this._getListTag(r.item.op))},e.prototype._renderListItem=function(e){e.item.op.attributes.indent=0;var t=new OpToHtmlConverter_1$1.OpToHtmlConverter(e.item.op,this.converterOptions).getHtmlParts(),r=this._renderInlines(e.item.ops,!1);return t.openingTag+r+(e.innerList?this._renderList(e.innerList):"")+t.closingTag},e.prototype._renderTable=function(e){var t=this;return funcs_html_1.makeStartTag("table")+funcs_html_1.makeStartTag("tbody")+e.rows.map((function(e){return t._renderTableRow(e)})).join("")+funcs_html_1.makeEndTag("tbody")+funcs_html_1.makeEndTag("table")},e.prototype._renderTableRow=function(e){var t=this;return funcs_html_1.makeStartTag("tr")+e.cells.map((function(e){return t._renderTableCell(e)})).join("")+funcs_html_1.makeEndTag("tr")},e.prototype._renderTableCell=function(e){var t=new OpToHtmlConverter_1$1.OpToHtmlConverter(e.item.op,this.converterOptions).getHtmlParts(),r=this._renderInlines(e.item.ops,!1);return funcs_html_1.makeStartTag("td",{key:"data-row",value:e.item.op.attributes.table})+t.openingTag+r+t.closingTag+funcs_html_1.makeEndTag("td")},e.prototype._renderBlock=function(e,t){var r=this,n=new OpToHtmlConverter_1$1.OpToHtmlConverter(e,this.converterOptions).getHtmlParts();if(e.isCodeBlock())return n.openingTag+funcs_html_1.encodeHtml(t.map((function(t){return t.isCustomEmbed()?r._renderCustom(t,e):t.insert.value})).join(""))+n.closingTag;var i=t.map((function(t){return r._renderInline(t,e)})).join("");return n.openingTag+(i||BrTag)+n.closingTag},e.prototype._renderInlines=function(e,t){var r=this;void 0===t&&(t=!0);var n=e.length-1,i=e.map((function(e,t){return t>0&&t===n&&e.isJustNewline()?"":r._renderInline(e,null)})).join("");if(!t)return i;var s=funcs_html_1.makeStartTag(this.options.paragraphTag),o=funcs_html_1.makeEndTag(this.options.paragraphTag);return i===BrTag||this.options.multiLineParagraph?s+i+o:s+i.split(BrTag).map((function(e){return""===e?BrTag:e})).join(o+s)+o},e.prototype._renderInline=function(e,t){return e.isCustomEmbed()?this._renderCustom(e,t):new OpToHtmlConverter_1$1.OpToHtmlConverter(e,this.converterOptions).getHtml().replace(/\n/g,BrTag)},e.prototype._renderCustom=function(e,t){var r=this.callbacks.renderCustomOp_cb;return"function"==typeof r?r.apply(null,[e,t]):""},e.prototype.beforeRender=function(e){"function"==typeof e&&(this.callbacks.beforeRender_cb=e)},e.prototype.afterRender=function(e){"function"==typeof e&&(this.callbacks.afterRender_cb=e)},e.prototype.renderCustomWith=function(e){this.callbacks.renderCustomOp_cb=e},e}();QuillDeltaToHtmlConverter$2.QuillDeltaToHtmlConverter=QuillDeltaToHtmlConverter$1,Object.defineProperty(main,"__esModule",{value:!0});var QuillDeltaToHtmlConverter_1=QuillDeltaToHtmlConverter$2,QuillDeltaToHtmlConverter=main.QuillDeltaToHtmlConverter=QuillDeltaToHtmlConverter_1.QuillDeltaToHtmlConverter,OpToHtmlConverter_1=OpToHtmlConverter;main.OpToHtmlConverter=OpToHtmlConverter_1.OpToHtmlConverter;var group_types_1=groupTypes;main.InlineGroup=group_types_1.InlineGroup,main.VideoItem=group_types_1.VideoItem,main.BlockGroup=group_types_1.BlockGroup,main.ListGroup=group_types_1.ListGroup,main.ListItem=group_types_1.ListItem,main.BlotBlock=group_types_1.BlotBlock;var DeltaInsertOp_1=DeltaInsertOp$1;main.DeltaInsertOp=DeltaInsertOp_1.DeltaInsertOp;var InsertData_1=InsertData;main.InsertDataQuill=InsertData_1.InsertDataQuill,main.InsertDataCustom=InsertData_1.InsertDataCustom;var value_types_1=valueTypes;main.NewLine=value_types_1.NewLine,main.ListType=value_types_1.ListType,main.ScriptType=value_types_1.ScriptType,main.DirectionType=value_types_1.DirectionType,main.AlignType=value_types_1.AlignType,main.DataType=value_types_1.DataType,main.GroupType=value_types_1.GroupType;var Transformer=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"convertDeltaToHtml",value:function(e,t){if(!e.ops)throw new Error("Incorrect delta format. Cannot find ops array.");var r=new QuillDeltaToHtmlConverter(e.ops,{multiLineParagraph:!1,multiLineCodeblock:!1,multiLineHeader:!1,multiLineBlockquote:!1,classPrefix:"u",urlSanitizer:function(e){return 0==e.indexOf("www.")?"https://".concat(e):e}});return r.renderCustomWith(t),r.convert()}}]),e}(),parser$8={},DLList$2;parser$8.load=function(e,t,r={}){var n,i,s;for(n in t)s=t[n],r[n]=null!=(i=e[n])?i:s;return r},parser$8.overwrite=function(e,t,r={}){var n,i;for(n in e)i=e[n],void 0!==t[n]&&(r[n]=i);return r},DLList$2=class{constructor(e,t){this.incr=e,this.decr=t,this._first=null,this._last=null,this.length=0}push(e){var t;this.length++,"function"==typeof this.incr&&this.incr(),t={value:e,prev:this._last,next:null},null!=this._last?(this._last.next=t,this._last=t):this._first=this._last=t}shift(){var e;if(null!=this._first)return this.length--,"function"==typeof this.decr&&this.decr(),e=this._first.value,null!=(this._first=this._first.next)?this._first.prev=null:this._last=null,e}first(){if(null!=this._first)return this._first.value}getArray(){var e,t,r;for(e=this._first,r=[];null!=e;)r.push((t=e,e=e.next,t.value));return r}forEachShift(e){var t;for(t=this.shift();null!=t;)e(t),t=this.shift()}debug(){var e,t,r,n,i;for(e=this._first,i=[];null!=e;)i.push((t=e,e=e.next,{value:t.value,prev:null!=(r=t.prev)?r.value:void 0,next:null!=(n=t.next)?n.value:void 0}));return i}};var DLList_1=DLList$2,Events$6;function asyncGeneratorStep$8(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator$8(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){asyncGeneratorStep$8(s,n,i,o,a,"next",e)}function a(e){asyncGeneratorStep$8(s,n,i,o,a,"throw",e)}o(void 0)}))}}Events$6=class{constructor(e){if(this.instance=e,this._events={},null!=this.instance.on||null!=this.instance.once||null!=this.instance.removeAllListeners)throw new Error("An Emitter already exists for this object");this.instance.on=(e,t)=>this._addListener(e,"many",t),this.instance.once=(e,t)=>this._addListener(e,"once",t),this.instance.removeAllListeners=(e=null)=>null!=e?delete this._events[e]:this._events={}}_addListener(e,t,r){var n;return null==(n=this._events)[e]&&(n[e]=[]),this._events[e].push({cb:r,status:t}),this.instance}listenerCount(e){return null!=this._events[e]?this._events[e].length:0}trigger(e,...t){var r=this;return _asyncToGenerator$8((function*(){var n,i;try{if("debug"!==e&&r.trigger("debug",`Event triggered: ${e}`,t),null==r._events[e])return;return r._events[e]=r._events[e].filter((function(e){return"none"!==e.status})),i=r._events[e].map(function(){var e=_asyncToGenerator$8((function*(e){var n,i;if("none"!==e.status){"once"===e.status&&(e.status="none");try{return"function"==typeof(null!=(i="function"==typeof e.cb?e.cb(...t):void 0)?i.then:void 0)?yield i:i}catch(e){return n=e,r.trigger("error",n),null}}}));return function(t){return e.apply(this,arguments)}}()),(yield Promise.all(i)).find((function(e){return null!=e}))}catch(e){return n=e,r.trigger("error",n),null}}))()}};var Events_1=Events$6,DLList$1,Events$5,Queues$1;DLList$1=DLList_1,Events$5=Events_1,Queues$1=class{constructor(e){this.Events=new Events$5(this),this._length=0,this._lists=function(){var t,r,n;for(n=[],t=1,r=e;1<=r?t<=r:t>=r;1<=r?++t:--t)n.push(new DLList$1((()=>this.incr()),(()=>this.decr())));return n}.call(this)}incr(){if(0==this._length++)return this.Events.trigger("leftzero")}decr(){if(0==--this._length)return this.Events.trigger("zero")}push(e){return this._lists[e.options.priority].push(e)}queued(e){return null!=e?this._lists[e].length:this._length}shiftAll(e){return this._lists.forEach((function(t){return t.forEachShift(e)}))}getFirst(e=this._lists){var t,r,n;for(t=0,r=e.length;t<r;t++)if((n=e[t]).length>0)return n;return[]}shiftLastFrom(e){return this.getFirst(this._lists.slice(e).reverse()).shift()}};var Queues_1=Queues$1,BottleneckError$4;BottleneckError$4=class extends Error{};var BottleneckError_1=BottleneckError$4,BottleneckError$3,DEFAULT_PRIORITY$1,Job$1,NUM_PRIORITIES$1,parser$7;function asyncGeneratorStep$7(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator$7(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){asyncGeneratorStep$7(s,n,i,o,a,"next",e)}function a(e){asyncGeneratorStep$7(s,n,i,o,a,"throw",e)}o(void 0)}))}}NUM_PRIORITIES$1=10,DEFAULT_PRIORITY$1=5,parser$7=parser$8,BottleneckError$3=BottleneckError_1,Job$1=class{constructor(e,t,r,n,i,s,o,a){this.task=e,this.args=t,this.rejectOnDrop=i,this.Events=s,this._states=o,this.Promise=a,this.options=parser$7.load(r,n),this.options.priority=this._sanitizePriority(this.options.priority),this.options.id===n.id&&(this.options.id=`${this.options.id}-${this._randomIndex()}`),this.promise=new this.Promise(((e,t)=>{this._resolve=e,this._reject=t})),this.retryCount=0}_sanitizePriority(e){var t;return(t=~~e!==e?DEFAULT_PRIORITY$1:e)<0?0:t>NUM_PRIORITIES$1-1?NUM_PRIORITIES$1-1:t}_randomIndex(){return Math.random().toString(36).slice(2)}doDrop({error:e,message:t="This job has been dropped by Bottleneck"}={}){return!!this._states.remove(this.options.id)&&(this.rejectOnDrop&&this._reject(null!=e?e:new BottleneckError$3(t)),this.Events.trigger("dropped",{args:this.args,options:this.options,task:this.task,promise:this.promise}),!0)}_assertStatus(e){var t;if((t=this._states.jobStatus(this.options.id))!==e&&("DONE"!==e||null!==t))throw new BottleneckError$3(`Invalid job status ${t}, expected ${e}. Please open an issue at https://github.com/SGrondin/bottleneck/issues`)}doReceive(){return this._states.start(this.options.id),this.Events.trigger("received",{args:this.args,options:this.options})}doQueue(e,t){return this._assertStatus("RECEIVED"),this._states.next(this.options.id),this.Events.trigger("queued",{args:this.args,options:this.options,reachedHWM:e,blocked:t})}doRun(){return 0===this.retryCount?(this._assertStatus("QUEUED"),this._states.next(this.options.id)):this._assertStatus("EXECUTING"),this.Events.trigger("scheduled",{args:this.args,options:this.options})}doExecute(e,t,r,n){var i=this;return _asyncToGenerator$7((function*(){var s,o,a;0===i.retryCount?(i._assertStatus("RUNNING"),i._states.next(i.options.id)):i._assertStatus("EXECUTING"),o={args:i.args,options:i.options,retryCount:i.retryCount},i.Events.trigger("executing",o);try{if(a=yield null!=e?e.schedule(i.options,i.task,...i.args):i.task(...i.args),t())return i.doDone(o),yield n(i.options,o),i._assertStatus("DONE"),i._resolve(a)}catch(e){return s=e,i._onFailure(s,o,t,r,n)}}))()}doExpire(e,t,r){var n,i;return this._states.jobStatus("RUNNING"===this.options.id)&&this._states.next(this.options.id),this._assertStatus("EXECUTING"),i={args:this.args,options:this.options,retryCount:this.retryCount},n=new BottleneckError$3(`This job timed out after ${this.options.expiration} ms.`),this._onFailure(n,i,e,t,r)}_onFailure(e,t,r,n,i){var s=this;return _asyncToGenerator$7((function*(){var o,a;if(r())return null!=(o=yield s.Events.trigger("failed",e,t))?(a=~~o,s.Events.trigger("retry",`Retrying ${s.options.id} after ${a} ms`,t),s.retryCount++,n(a)):(s.doDone(t),yield i(s.options,t),s._assertStatus("DONE"),s._reject(e))}))()}doDone(e){return this._assertStatus("EXECUTING"),this._states.next(this.options.id),this.Events.trigger("done",e)}};var Job_1=Job$1,BottleneckError$2,LocalDatastore$1,parser$6;function asyncGeneratorStep$6(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator$6(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){asyncGeneratorStep$6(s,n,i,o,a,"next",e)}function a(e){asyncGeneratorStep$6(s,n,i,o,a,"throw",e)}o(void 0)}))}}parser$6=parser$8,BottleneckError$2=BottleneckError_1,LocalDatastore$1=class{constructor(e,t,r){this.instance=e,this.storeOptions=t,this.clientId=this.instance._randomIndex(),parser$6.load(r,r,this),this._nextRequest=this._lastReservoirRefresh=this._lastReservoirIncrease=Date.now(),this._running=0,this._done=0,this._unblockTime=0,this.ready=this.Promise.resolve(),this.clients={},this._startHeartbeat()}_startHeartbeat(){var e;return null==this.heartbeat&&(null!=this.storeOptions.reservoirRefreshInterval&&null!=this.storeOptions.reservoirRefreshAmount||null!=this.storeOptions.reservoirIncreaseInterval&&null!=this.storeOptions.reservoirIncreaseAmount)?"function"==typeof(e=this.heartbeat=setInterval((()=>{var e,t,r,n,i;if(n=Date.now(),null!=this.storeOptions.reservoirRefreshInterval&&n>=this._lastReservoirRefresh+this.storeOptions.reservoirRefreshInterval&&(this._lastReservoirRefresh=n,this.storeOptions.reservoir=this.storeOptions.reservoirRefreshAmount,this.instance._drainAll(this.computeCapacity())),null!=this.storeOptions.reservoirIncreaseInterval&&n>=this._lastReservoirIncrease+this.storeOptions.reservoirIncreaseInterval){var s=this.storeOptions;if(e=s.reservoirIncreaseAmount,r=s.reservoirIncreaseMaximum,i=s.reservoir,this._lastReservoirIncrease=n,(t=null!=r?Math.min(e,r-i):e)>0)return this.storeOptions.reservoir+=t,this.instance._drainAll(this.computeCapacity())}}),this.heartbeatInterval)).unref?e.unref():void 0:clearInterval(this.heartbeat)}__publish__(e){var t=this;return _asyncToGenerator$6((function*(){return yield t.yieldLoop(),t.instance.Events.trigger("message",e.toString())}))()}__disconnect__(e){var t=this;return _asyncToGenerator$6((function*(){return yield t.yieldLoop(),clearInterval(t.heartbeat),t.Promise.resolve()}))()}yieldLoop(e=0){return new this.Promise((function(t,r){return setTimeout(t,e)}))}computePenalty(){var e;return null!=(e=this.storeOptions.penalty)?e:15*this.storeOptions.minTime||5e3}__updateSettings__(e){var t=this;return _asyncToGenerator$6((function*(){return yield t.yieldLoop(),parser$6.overwrite(e,e,t.storeOptions),t._startHeartbeat(),t.instance._drainAll(t.computeCapacity()),!0}))()}__running__(){var e=this;return _asyncToGenerator$6((function*(){return yield e.yieldLoop(),e._running}))()}__queued__(){var e=this;return _asyncToGenerator$6((function*(){return yield e.yieldLoop(),e.instance.queued()}))()}__done__(){var e=this;return _asyncToGenerator$6((function*(){return yield e.yieldLoop(),e._done}))()}__groupCheck__(e){var t=this;return _asyncToGenerator$6((function*(){return yield t.yieldLoop(),t._nextRequest+t.timeout<e}))()}computeCapacity(){var e,t,r=this.storeOptions;return e=r.maxConcurrent,t=r.reservoir,null!=e&&null!=t?Math.min(e-this._running,t):null!=e?e-this._running:null!=t?t:null}conditionsCheck(e){var t;return null==(t=this.computeCapacity())||e<=t}__incrementReservoir__(e){var t=this;return _asyncToGenerator$6((function*(){var r;return yield t.yieldLoop(),r=t.storeOptions.reservoir+=e,t.instance._drainAll(t.computeCapacity()),r}))()}__currentReservoir__(){var e=this;return _asyncToGenerator$6((function*(){return yield e.yieldLoop(),e.storeOptions.reservoir}))()}isBlocked(e){return this._unblockTime>=e}check(e,t){return this.conditionsCheck(e)&&this._nextRequest-t<=0}__check__(e){var t=this;return _asyncToGenerator$6((function*(){var r;return yield t.yieldLoop(),r=Date.now(),t.check(e,r)}))()}__register__(e,t,r){var n=this;return _asyncToGenerator$6((function*(){var e,r;return yield n.yieldLoop(),e=Date.now(),n.conditionsCheck(t)?(n._running+=t,null!=n.storeOptions.reservoir&&(n.storeOptions.reservoir-=t),r=Math.max(n._nextRequest-e,0),n._nextRequest=e+r+n.storeOptions.minTime,{success:!0,wait:r,reservoir:n.storeOptions.reservoir}):{success:!1}}))()}strategyIsBlock(){return 3===this.storeOptions.strategy}__submit__(e,t){var r=this;return _asyncToGenerator$6((function*(){var n,i,s;if(yield r.yieldLoop(),null!=r.storeOptions.maxConcurrent&&t>r.storeOptions.maxConcurrent)throw new BottleneckError$2(`Impossible to add a job having a weight of ${t} to a limiter having a maxConcurrent setting of ${r.storeOptions.maxConcurrent}`);return i=Date.now(),s=null!=r.storeOptions.highWater&&e===r.storeOptions.highWater&&!r.check(t,i),(n=r.strategyIsBlock()&&(s||r.isBlocked(i)))&&(r._unblockTime=i+r.computePenalty(),r._nextRequest=r._unblockTime+r.storeOptions.minTime,r.instance._dropAllQueued()),{reachedHWM:s,blocked:n,strategy:r.storeOptions.strategy}}))()}__free__(e,t){var r=this;return _asyncToGenerator$6((function*(){return yield r.yieldLoop(),r._running-=t,r._done+=t,r.instance._drainAll(r.computeCapacity()),{running:r._running}}))()}};var LocalDatastore_1=LocalDatastore$1,Scripts$3={},require$$0={"blacklist_client.lua":"local blacklist = ARGV[num_static_argv + 1]\n\nif redis.call('zscore', client_last_seen_key, blacklist) then\n  redis.call('zadd', client_last_seen_key, 0, blacklist)\nend\n\n\nreturn {}\n","check.lua":"local weight = tonumber(ARGV[num_static_argv + 1])\n\nlocal capacity = process_tick(now, false)['capacity']\nlocal nextRequest = tonumber(redis.call('hget', settings_key, 'nextRequest'))\n\nreturn conditions_check(capacity, weight) and nextRequest - now <= 0\n","conditions_check.lua":"local conditions_check = function (capacity, weight)\n  return capacity == nil or weight <= capacity\nend\n","current_reservoir.lua":"return process_tick(now, false)['reservoir']\n","done.lua":"process_tick(now, false)\n\nreturn tonumber(redis.call('hget', settings_key, 'done'))\n","free.lua":"local index = ARGV[num_static_argv + 1]\n\nredis.call('zadd', job_expirations_key, 0, index)\n\nreturn process_tick(now, false)['running']\n","get_time.lua":"redis.replicate_commands()\n\nlocal get_time = function ()\n  local time = redis.call('time')\n\n  return tonumber(time[1]..string.sub(time[2], 1, 3))\nend\n","group_check.lua":"return not (redis.call('exists', settings_key) == 1)\n","heartbeat.lua":"process_tick(now, true)\n","increment_reservoir.lua":"local incr = tonumber(ARGV[num_static_argv + 1])\n\nredis.call('hincrby', settings_key, 'reservoir', incr)\n\nlocal reservoir = process_tick(now, true)['reservoir']\n\nlocal groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))\nrefresh_expiration(0, 0, groupTimeout)\n\nreturn reservoir\n","init.lua":"local clear = tonumber(ARGV[num_static_argv + 1])\nlocal limiter_version = ARGV[num_static_argv + 2]\nlocal num_local_argv = num_static_argv + 2\n\nif clear == 1 then\n  redis.call('del', unpack(KEYS))\nend\n\nif redis.call('exists', settings_key) == 0 then\n  -- Create\n  local args = {'hmset', settings_key}\n\n  for i = num_local_argv + 1, #ARGV do\n    table.insert(args, ARGV[i])\n  end\n\n  redis.call(unpack(args))\n  redis.call('hmset', settings_key,\n    'nextRequest', now,\n    'lastReservoirRefresh', now,\n    'lastReservoirIncrease', now,\n    'running', 0,\n    'done', 0,\n    'unblockTime', 0,\n    'capacityPriorityCounter', 0\n  )\n\nelse\n  -- Apply migrations\n  local settings = redis.call('hmget', settings_key,\n    'id',\n    'version'\n  )\n  local id = settings[1]\n  local current_version = settings[2]\n\n  if current_version ~= limiter_version then\n    local version_digits = {}\n    for k, v in string.gmatch(current_version, \"([^.]+)\") do\n      table.insert(version_digits, tonumber(k))\n    end\n\n    -- 2.10.0\n    if version_digits[2] < 10 then\n      redis.call('hsetnx', settings_key, 'reservoirRefreshInterval', '')\n      redis.call('hsetnx', settings_key, 'reservoirRefreshAmount', '')\n      redis.call('hsetnx', settings_key, 'lastReservoirRefresh', '')\n      redis.call('hsetnx', settings_key, 'done', 0)\n      redis.call('hset', settings_key, 'version', '2.10.0')\n    end\n\n    -- 2.11.1\n    if version_digits[2] < 11 or (version_digits[2] == 11 and version_digits[3] < 1) then\n      if redis.call('hstrlen', settings_key, 'lastReservoirRefresh') == 0 then\n        redis.call('hmset', settings_key,\n          'lastReservoirRefresh', now,\n          'version', '2.11.1'\n        )\n      end\n    end\n\n    -- 2.14.0\n    if version_digits[2] < 14 then\n      local old_running_key = 'b_'..id..'_running'\n      local old_executing_key = 'b_'..id..'_executing'\n\n      if redis.call('exists', old_running_key) == 1 then\n        redis.call('rename', old_running_key, job_weights_key)\n      end\n      if redis.call('exists', old_executing_key) == 1 then\n        redis.call('rename', old_executing_key, job_expirations_key)\n      end\n      redis.call('hset', settings_key, 'version', '2.14.0')\n    end\n\n    -- 2.15.2\n    if version_digits[2] < 15 or (version_digits[2] == 15 and version_digits[3] < 2) then\n      redis.call('hsetnx', settings_key, 'capacityPriorityCounter', 0)\n      redis.call('hset', settings_key, 'version', '2.15.2')\n    end\n\n    -- 2.17.0\n    if version_digits[2] < 17 then\n      redis.call('hsetnx', settings_key, 'clientTimeout', 10000)\n      redis.call('hset', settings_key, 'version', '2.17.0')\n    end\n\n    -- 2.18.0\n    if version_digits[2] < 18 then\n      redis.call('hsetnx', settings_key, 'reservoirIncreaseInterval', '')\n      redis.call('hsetnx', settings_key, 'reservoirIncreaseAmount', '')\n      redis.call('hsetnx', settings_key, 'reservoirIncreaseMaximum', '')\n      redis.call('hsetnx', settings_key, 'lastReservoirIncrease', now)\n      redis.call('hset', settings_key, 'version', '2.18.0')\n    end\n\n  end\n\n  process_tick(now, false)\nend\n\nlocal groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))\nrefresh_expiration(0, 0, groupTimeout)\n\nreturn {}\n","process_tick.lua":"local process_tick = function (now, always_publish)\n\n  local compute_capacity = function (maxConcurrent, running, reservoir)\n    if maxConcurrent ~= nil and reservoir ~= nil then\n      return math.min((maxConcurrent - running), reservoir)\n    elseif maxConcurrent ~= nil then\n      return maxConcurrent - running\n    elseif reservoir ~= nil then\n      return reservoir\n    else\n      return nil\n    end\n  end\n\n  local settings = redis.call('hmget', settings_key,\n    'id',\n    'maxConcurrent',\n    'running',\n    'reservoir',\n    'reservoirRefreshInterval',\n    'reservoirRefreshAmount',\n    'lastReservoirRefresh',\n    'reservoirIncreaseInterval',\n    'reservoirIncreaseAmount',\n    'reservoirIncreaseMaximum',\n    'lastReservoirIncrease',\n    'capacityPriorityCounter',\n    'clientTimeout'\n  )\n  local id = settings[1]\n  local maxConcurrent = tonumber(settings[2])\n  local running = tonumber(settings[3])\n  local reservoir = tonumber(settings[4])\n  local reservoirRefreshInterval = tonumber(settings[5])\n  local reservoirRefreshAmount = tonumber(settings[6])\n  local lastReservoirRefresh = tonumber(settings[7])\n  local reservoirIncreaseInterval = tonumber(settings[8])\n  local reservoirIncreaseAmount = tonumber(settings[9])\n  local reservoirIncreaseMaximum = tonumber(settings[10])\n  local lastReservoirIncrease = tonumber(settings[11])\n  local capacityPriorityCounter = tonumber(settings[12])\n  local clientTimeout = tonumber(settings[13])\n\n  local initial_capacity = compute_capacity(maxConcurrent, running, reservoir)\n\n  --\n  -- Process 'running' changes\n  --\n  local expired = redis.call('zrangebyscore', job_expirations_key, '-inf', '('..now)\n\n  if #expired > 0 then\n    redis.call('zremrangebyscore', job_expirations_key, '-inf', '('..now)\n\n    local flush_batch = function (batch, acc)\n      local weights = redis.call('hmget', job_weights_key, unpack(batch))\n                      redis.call('hdel',  job_weights_key, unpack(batch))\n      local clients = redis.call('hmget', job_clients_key, unpack(batch))\n                      redis.call('hdel',  job_clients_key, unpack(batch))\n\n      -- Calculate sum of removed weights\n      for i = 1, #weights do\n        acc['total'] = acc['total'] + (tonumber(weights[i]) or 0)\n      end\n\n      -- Calculate sum of removed weights by client\n      local client_weights = {}\n      for i = 1, #clients do\n        local removed = tonumber(weights[i]) or 0\n        if removed > 0 then\n          acc['client_weights'][clients[i]] = (acc['client_weights'][clients[i]] or 0) + removed\n        end\n      end\n    end\n\n    local acc = {\n      ['total'] = 0,\n      ['client_weights'] = {}\n    }\n    local batch_size = 1000\n\n    -- Compute changes to Zsets and apply changes to Hashes\n    for i = 1, #expired, batch_size do\n      local batch = {}\n      for j = i, math.min(i + batch_size - 1, #expired) do\n        table.insert(batch, expired[j])\n      end\n\n      flush_batch(batch, acc)\n    end\n\n    -- Apply changes to Zsets\n    if acc['total'] > 0 then\n      redis.call('hincrby', settings_key, 'done', acc['total'])\n      running = tonumber(redis.call('hincrby', settings_key, 'running', -acc['total']))\n    end\n\n    for client, weight in pairs(acc['client_weights']) do\n      redis.call('zincrby', client_running_key, -weight, client)\n    end\n  end\n\n  --\n  -- Process 'reservoir' changes\n  --\n  local reservoirRefreshActive = reservoirRefreshInterval ~= nil and reservoirRefreshAmount ~= nil\n  if reservoirRefreshActive and now >= lastReservoirRefresh + reservoirRefreshInterval then\n    reservoir = reservoirRefreshAmount\n    redis.call('hmset', settings_key,\n      'reservoir', reservoir,\n      'lastReservoirRefresh', now\n    )\n  end\n\n  local reservoirIncreaseActive = reservoirIncreaseInterval ~= nil and reservoirIncreaseAmount ~= nil\n  if reservoirIncreaseActive and now >= lastReservoirIncrease + reservoirIncreaseInterval then\n    local num_intervals = math.floor((now - lastReservoirIncrease) / reservoirIncreaseInterval)\n    local incr = reservoirIncreaseAmount * num_intervals\n    if reservoirIncreaseMaximum ~= nil then\n      incr = math.min(incr, reservoirIncreaseMaximum - (reservoir or 0))\n    end\n    if incr > 0 then\n      reservoir = (reservoir or 0) + incr\n    end\n    redis.call('hmset', settings_key,\n      'reservoir', reservoir,\n      'lastReservoirIncrease', lastReservoirIncrease + (num_intervals * reservoirIncreaseInterval)\n    )\n  end\n\n  --\n  -- Clear unresponsive clients\n  --\n  local unresponsive = redis.call('zrangebyscore', client_last_seen_key, '-inf', (now - clientTimeout))\n  local unresponsive_lookup = {}\n  local terminated_clients = {}\n  for i = 1, #unresponsive do\n    unresponsive_lookup[unresponsive[i]] = true\n    if tonumber(redis.call('zscore', client_running_key, unresponsive[i])) == 0 then\n      table.insert(terminated_clients, unresponsive[i])\n    end\n  end\n  if #terminated_clients > 0 then\n    redis.call('zrem', client_running_key,         unpack(terminated_clients))\n    redis.call('hdel', client_num_queued_key,      unpack(terminated_clients))\n    redis.call('zrem', client_last_registered_key, unpack(terminated_clients))\n    redis.call('zrem', client_last_seen_key,       unpack(terminated_clients))\n  end\n\n  --\n  -- Broadcast capacity changes\n  --\n  local final_capacity = compute_capacity(maxConcurrent, running, reservoir)\n\n  if always_publish or (initial_capacity ~= nil and final_capacity == nil) then\n    -- always_publish or was not unlimited, now unlimited\n    redis.call('publish', 'b_'..id, 'capacity:'..(final_capacity or ''))\n\n  elseif initial_capacity ~= nil and final_capacity ~= nil and final_capacity > initial_capacity then\n    -- capacity was increased\n    -- send the capacity message to the limiter having the lowest number of running jobs\n    -- the tiebreaker is the limiter having not registered a job in the longest time\n\n    local lowest_concurrency_value = nil\n    local lowest_concurrency_clients = {}\n    local lowest_concurrency_last_registered = {}\n    local client_concurrencies = redis.call('zrange', client_running_key, 0, -1, 'withscores')\n\n    for i = 1, #client_concurrencies, 2 do\n      local client = client_concurrencies[i]\n      local concurrency = tonumber(client_concurrencies[i+1])\n\n      if (\n        lowest_concurrency_value == nil or lowest_concurrency_value == concurrency\n      ) and (\n        not unresponsive_lookup[client]\n      ) and (\n        tonumber(redis.call('hget', client_num_queued_key, client)) > 0\n      ) then\n        lowest_concurrency_value = concurrency\n        table.insert(lowest_concurrency_clients, client)\n        local last_registered = tonumber(redis.call('zscore', client_last_registered_key, client))\n        table.insert(lowest_concurrency_last_registered, last_registered)\n      end\n    end\n\n    if #lowest_concurrency_clients > 0 then\n      local position = 1\n      local earliest = lowest_concurrency_last_registered[1]\n\n      for i,v in ipairs(lowest_concurrency_last_registered) do\n        if v < earliest then\n          position = i\n          earliest = v\n        end\n      end\n\n      local next_client = lowest_concurrency_clients[position]\n      redis.call('publish', 'b_'..id,\n        'capacity-priority:'..(final_capacity or '')..\n        ':'..next_client..\n        ':'..capacityPriorityCounter\n      )\n      redis.call('hincrby', settings_key, 'capacityPriorityCounter', '1')\n    else\n      redis.call('publish', 'b_'..id, 'capacity:'..(final_capacity or ''))\n    end\n  end\n\n  return {\n    ['capacity'] = final_capacity,\n    ['running'] = running,\n    ['reservoir'] = reservoir\n  }\nend\n","queued.lua":"local clientTimeout = tonumber(redis.call('hget', settings_key, 'clientTimeout'))\nlocal valid_clients = redis.call('zrangebyscore', client_last_seen_key, (now - clientTimeout), 'inf')\nlocal client_queued = redis.call('hmget', client_num_queued_key, unpack(valid_clients))\n\nlocal sum = 0\nfor i = 1, #client_queued do\n  sum = sum + tonumber(client_queued[i])\nend\n\nreturn sum\n","refresh_expiration.lua":"local refresh_expiration = function (now, nextRequest, groupTimeout)\n\n  if groupTimeout ~= nil then\n    local ttl = (nextRequest + groupTimeout) - now\n\n    for i = 1, #KEYS do\n      redis.call('pexpire', KEYS[i], ttl)\n    end\n  end\n\nend\n","refs.lua":"local settings_key = KEYS[1]\nlocal job_weights_key = KEYS[2]\nlocal job_expirations_key = KEYS[3]\nlocal job_clients_key = KEYS[4]\nlocal client_running_key = KEYS[5]\nlocal client_num_queued_key = KEYS[6]\nlocal client_last_registered_key = KEYS[7]\nlocal client_last_seen_key = KEYS[8]\n\nlocal now = tonumber(ARGV[1])\nlocal client = ARGV[2]\n\nlocal num_static_argv = 2\n","register.lua":"local index = ARGV[num_static_argv + 1]\nlocal weight = tonumber(ARGV[num_static_argv + 2])\nlocal expiration = tonumber(ARGV[num_static_argv + 3])\n\nlocal state = process_tick(now, false)\nlocal capacity = state['capacity']\nlocal reservoir = state['reservoir']\n\nlocal settings = redis.call('hmget', settings_key,\n  'nextRequest',\n  'minTime',\n  'groupTimeout'\n)\nlocal nextRequest = tonumber(settings[1])\nlocal minTime = tonumber(settings[2])\nlocal groupTimeout = tonumber(settings[3])\n\nif conditions_check(capacity, weight) then\n\n  redis.call('hincrby', settings_key, 'running', weight)\n  redis.call('hset', job_weights_key, index, weight)\n  if expiration ~= nil then\n    redis.call('zadd', job_expirations_key, now + expiration, index)\n  end\n  redis.call('hset', job_clients_key, index, client)\n  redis.call('zincrby', client_running_key, weight, client)\n  redis.call('hincrby', client_num_queued_key, client, -1)\n  redis.call('zadd', client_last_registered_key, now, client)\n\n  local wait = math.max(nextRequest - now, 0)\n  local newNextRequest = now + wait + minTime\n\n  if reservoir == nil then\n    redis.call('hset', settings_key,\n      'nextRequest', newNextRequest\n    )\n  else\n    reservoir = reservoir - weight\n    redis.call('hmset', settings_key,\n      'reservoir', reservoir,\n      'nextRequest', newNextRequest\n    )\n  end\n\n  refresh_expiration(now, newNextRequest, groupTimeout)\n\n  return {true, wait, reservoir}\n\nelse\n  return {false}\nend\n","register_client.lua":"local queued = tonumber(ARGV[num_static_argv + 1])\n\n-- Could have been re-registered concurrently\nif not redis.call('zscore', client_last_seen_key, client) then\n  redis.call('zadd', client_running_key, 0, client)\n  redis.call('hset', client_num_queued_key, client, queued)\n  redis.call('zadd', client_last_registered_key, 0, client)\nend\n\nredis.call('zadd', client_last_seen_key, now, client)\n\nreturn {}\n","running.lua":"return process_tick(now, false)['running']\n","submit.lua":"local queueLength = tonumber(ARGV[num_static_argv + 1])\nlocal weight = tonumber(ARGV[num_static_argv + 2])\n\nlocal capacity = process_tick(now, false)['capacity']\n\nlocal settings = redis.call('hmget', settings_key,\n  'id',\n  'maxConcurrent',\n  'highWater',\n  'nextRequest',\n  'strategy',\n  'unblockTime',\n  'penalty',\n  'minTime',\n  'groupTimeout'\n)\nlocal id = settings[1]\nlocal maxConcurrent = tonumber(settings[2])\nlocal highWater = tonumber(settings[3])\nlocal nextRequest = tonumber(settings[4])\nlocal strategy = tonumber(settings[5])\nlocal unblockTime = tonumber(settings[6])\nlocal penalty = tonumber(settings[7])\nlocal minTime = tonumber(settings[8])\nlocal groupTimeout = tonumber(settings[9])\n\nif maxConcurrent ~= nil and weight > maxConcurrent then\n  return redis.error_reply('OVERWEIGHT:'..weight..':'..maxConcurrent)\nend\n\nlocal reachedHWM = (highWater ~= nil and queueLength == highWater\n  and not (\n    conditions_check(capacity, weight)\n    and nextRequest - now <= 0\n  )\n)\n\nlocal blocked = strategy == 3 and (reachedHWM or unblockTime >= now)\n\nif blocked then\n  local computedPenalty = penalty\n  if computedPenalty == nil then\n    if minTime == 0 then\n      computedPenalty = 5000\n    else\n      computedPenalty = 15 * minTime\n    end\n  end\n\n  local newNextRequest = now + computedPenalty + minTime\n\n  redis.call('hmset', settings_key,\n    'unblockTime', now + computedPenalty,\n    'nextRequest', newNextRequest\n  )\n\n  local clients_queued_reset = redis.call('hkeys', client_num_queued_key)\n  local queued_reset = {}\n  for i = 1, #clients_queued_reset do\n    table.insert(queued_reset, clients_queued_reset[i])\n    table.insert(queued_reset, 0)\n  end\n  redis.call('hmset', client_num_queued_key, unpack(queued_reset))\n\n  redis.call('publish', 'b_'..id, 'blocked:')\n\n  refresh_expiration(now, newNextRequest, groupTimeout)\nend\n\nif not blocked and not reachedHWM then\n  redis.call('hincrby', client_num_queued_key, client, 1)\nend\n\nreturn {reachedHWM, blocked, strategy}\n","update_settings.lua":"local args = {'hmset', settings_key}\n\nfor i = num_static_argv + 1, #ARGV do\n  table.insert(args, ARGV[i])\nend\n\nredis.call(unpack(args))\n\nprocess_tick(now, true)\n\nlocal groupTimeout = tonumber(redis.call('hget', settings_key, 'groupTimeout'))\nrefresh_expiration(0, 0, groupTimeout)\n\nreturn {}\n","validate_client.lua":"if not redis.call('zscore', client_last_seen_key, client) then\n  return redis.error_reply('UNKNOWN_CLIENT')\nend\n\nredis.call('zadd', client_last_seen_key, now, client)\n","validate_keys.lua":"if not (redis.call('exists', settings_key) == 1) then\n  return redis.error_reply('SETTINGS_KEY_NOT_FOUND')\nend\n"},Events$4,RedisConnection$2,Scripts$2,parser$5;function asyncGeneratorStep$5(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator$5(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){asyncGeneratorStep$5(s,n,i,o,a,"next",e)}function a(e){asyncGeneratorStep$5(s,n,i,o,a,"throw",e)}o(void 0)}))}}!function(e){var t,r,n;t={refs:(r=require$$0)["refs.lua"],validate_keys:r["validate_keys.lua"],validate_client:r["validate_client.lua"],refresh_expiration:r["refresh_expiration.lua"],process_tick:r["process_tick.lua"],conditions_check:r["conditions_check.lua"],get_time:r["get_time.lua"]},e.allKeys=function(e){return[`b_${e}_settings`,`b_${e}_job_weights`,`b_${e}_job_expirations`,`b_${e}_job_clients`,`b_${e}_client_running`,`b_${e}_client_num_queued`,`b_${e}_client_last_registered`,`b_${e}_client_last_seen`]},n={init:{keys:e.allKeys,headers:["process_tick"],refresh_expiration:!0,code:r["init.lua"]},group_check:{keys:e.allKeys,headers:[],refresh_expiration:!1,code:r["group_check.lua"]},register_client:{keys:e.allKeys,headers:["validate_keys"],refresh_expiration:!1,code:r["register_client.lua"]},blacklist_client:{keys:e.allKeys,headers:["validate_keys","validate_client"],refresh_expiration:!1,code:r["blacklist_client.lua"]},heartbeat:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:r["heartbeat.lua"]},update_settings:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!0,code:r["update_settings.lua"]},running:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:r["running.lua"]},queued:{keys:e.allKeys,headers:["validate_keys","validate_client"],refresh_expiration:!1,code:r["queued.lua"]},done:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:r["done.lua"]},check:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick","conditions_check"],refresh_expiration:!1,code:r["check.lua"]},submit:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick","conditions_check"],refresh_expiration:!0,code:r["submit.lua"]},register:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick","conditions_check"],refresh_expiration:!0,code:r["register.lua"]},free:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!0,code:r["free.lua"]},current_reservoir:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!1,code:r["current_reservoir.lua"]},increment_reservoir:{keys:e.allKeys,headers:["validate_keys","validate_client","process_tick"],refresh_expiration:!0,code:r["increment_reservoir.lua"]}},e.names=Object.keys(n),e.keys=function(e,t){return n[e].keys(t)},e.payload=function(e){var r;return r=n[e],Array.prototype.concat(t.refs,r.headers.map((function(e){return t[e]})),r.refresh_expiration?t.refresh_expiration:"",r.code).join("\n")}}(Scripts$3),parser$5=parser$8,Events$4=Events_1,Scripts$2=Scripts$3,RedisConnection$2=function(){class RedisConnection{constructor(options={}){parser$5.load(options,this.defaults,this),null==this.Redis&&(this.Redis=eval("require")("redis")),null==this.Events&&(this.Events=new Events$4(this)),this.terminated=!1,null==this.client&&(this.client=this.Redis.createClient(this.clientOptions)),this.subscriber=this.client.duplicate(),this.limiters={},this.shas={},this.ready=this.Promise.all([this._setup(this.client,!1),this._setup(this.subscriber,!0)]).then((()=>this._loadScripts())).then((()=>({client:this.client,subscriber:this.subscriber})))}_setup(e,t){return e.setMaxListeners(0),new this.Promise(((r,n)=>(e.on("error",(e=>this.Events.trigger("error",e))),t&&e.on("message",((e,t)=>{var r;return null!=(r=this.limiters[e])?r._store.onMessage(e,t):void 0})),e.ready?r():e.once("ready",r))))}_loadScript(e){return new this.Promise(((t,r)=>{var n;return n=Scripts$2.payload(e),this.client.multi([["script","load",n]]).exec(((n,i)=>null!=n?r(n):(this.shas[e]=i[0],t(i[0]))))}))}_loadScripts(){return this.Promise.all(Scripts$2.names.map((e=>this._loadScript(e))))}__runCommand__(e){var t=this;return _asyncToGenerator$5((function*(){return yield t.ready,new t.Promise(((r,n)=>t.client.multi([e]).exec_atomic((function(e,t){return null!=e?n(e):r(t[0])}))))}))()}__addLimiter__(e){return this.Promise.all([e.channel(),e.channel_client()].map((t=>new this.Promise(((r,n)=>{var i;return i=n=>{if(n===t)return this.subscriber.removeListener("subscribe",i),this.limiters[t]=e,r()},this.subscriber.on("subscribe",i),this.subscriber.subscribe(t)})))))}__removeLimiter__(e){var t=this;return this.Promise.all([e.channel(),e.channel_client()].map(function(){var e=_asyncToGenerator$5((function*(e){return t.terminated||(yield new t.Promise(((r,n)=>t.subscriber.unsubscribe(e,(function(t,i){return null!=t?n(t):i===e?r():void 0}))))),delete t.limiters[e]}));return function(t){return e.apply(this,arguments)}}()))}__scriptArgs__(e,t,r,n){var i;return i=Scripts$2.keys(e,t),[this.shas[e],i.length].concat(i,r,n)}__scriptFn__(e){return this.client.evalsha.bind(this.client)}disconnect(e=!0){var t,r,n,i;for(t=0,n=(i=Object.keys(this.limiters)).length;t<n;t++)r=i[t],clearInterval(this.limiters[r]._store.heartbeat);return this.limiters={},this.terminated=!0,this.client.end(e),this.subscriber.end(e),this.Promise.resolve()}}return RedisConnection.prototype.datastore="redis",RedisConnection.prototype.defaults={Redis:null,clientOptions:{},client:null,Promise:Promise,Events:null},RedisConnection}.call(void 0);var RedisConnection_1=RedisConnection$2,Events$3,IORedisConnection$2,Scripts$1,parser$4;function _slicedToArray$3(e,t){return _arrayWithHoles$3(e)||_iterableToArrayLimit$3(e,t)||_nonIterableRest$3()}function _nonIterableRest$3(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit$3(e,t){var r=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return r}function _arrayWithHoles$3(e){if(Array.isArray(e))return e}function asyncGeneratorStep$4(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator$4(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){asyncGeneratorStep$4(s,n,i,o,a,"next",e)}function a(e){asyncGeneratorStep$4(s,n,i,o,a,"throw",e)}o(void 0)}))}}parser$4=parser$8,Events$3=Events_1,Scripts$1=Scripts$3,IORedisConnection$2=function(){class IORedisConnection{constructor(options={}){parser$4.load(options,this.defaults,this),null==this.Redis&&(this.Redis=eval("require")("ioredis")),null==this.Events&&(this.Events=new Events$3(this)),this.terminated=!1,null!=this.clusterNodes?(this.client=new this.Redis.Cluster(this.clusterNodes,this.clientOptions),this.subscriber=new this.Redis.Cluster(this.clusterNodes,this.clientOptions)):null!=this.client&&null==this.client.duplicate?this.subscriber=new this.Redis.Cluster(this.client.startupNodes,this.client.options):(null==this.client&&(this.client=new this.Redis(this.clientOptions)),this.subscriber=this.client.duplicate()),this.limiters={},this.ready=this.Promise.all([this._setup(this.client,!1),this._setup(this.subscriber,!0)]).then((()=>(this._loadScripts(),{client:this.client,subscriber:this.subscriber})))}_setup(e,t){return e.setMaxListeners(0),new this.Promise(((r,n)=>(e.on("error",(e=>this.Events.trigger("error",e))),t&&e.on("message",((e,t)=>{var r;return null!=(r=this.limiters[e])?r._store.onMessage(e,t):void 0})),"ready"===e.status?r():e.once("ready",r))))}_loadScripts(){return Scripts$1.names.forEach((e=>this.client.defineCommand(e,{lua:Scripts$1.payload(e)})))}__runCommand__(e){var t=this;return _asyncToGenerator$4((function*(){yield t.ready;var r=_slicedToArray$3(yield t.client.pipeline([e]).exec(),1);return _slicedToArray$3(r[0],2)[1]}))()}__addLimiter__(e){return this.Promise.all([e.channel(),e.channel_client()].map((t=>new this.Promise(((r,n)=>this.subscriber.subscribe(t,(()=>(this.limiters[t]=e,r()))))))))}__removeLimiter__(e){var t=this;return[e.channel(),e.channel_client()].forEach(function(){var e=_asyncToGenerator$4((function*(e){return t.terminated||(yield t.subscriber.unsubscribe(e)),delete t.limiters[e]}));return function(t){return e.apply(this,arguments)}}())}__scriptArgs__(e,t,r,n){var i;return[(i=Scripts$1.keys(e,t)).length].concat(i,r,n)}__scriptFn__(e){return this.client[e].bind(this.client)}disconnect(e=!0){var t,r,n,i;for(t=0,n=(i=Object.keys(this.limiters)).length;t<n;t++)r=i[t],clearInterval(this.limiters[r]._store.heartbeat);return this.limiters={},this.terminated=!0,e?this.Promise.all([this.client.quit(),this.subscriber.quit()]):(this.client.disconnect(),this.subscriber.disconnect(),this.Promise.resolve())}}return IORedisConnection.prototype.datastore="ioredis",IORedisConnection.prototype.defaults={Redis:null,clientOptions:{},clusterNodes:null,client:null,Promise:Promise,Events:null},IORedisConnection}.call(void 0);var IORedisConnection_1=IORedisConnection$2,BottleneckError$1,IORedisConnection$1,RedisConnection$1,RedisDatastore$1,parser$3;function _slicedToArray$2(e,t){return _arrayWithHoles$2(e)||_iterableToArrayLimit$2(e,t)||_nonIterableRest$2()}function _nonIterableRest$2(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit$2(e,t){var r=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return r}function _arrayWithHoles$2(e){if(Array.isArray(e))return e}function asyncGeneratorStep$3(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator$3(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){asyncGeneratorStep$3(s,n,i,o,a,"next",e)}function a(e){asyncGeneratorStep$3(s,n,i,o,a,"throw",e)}o(void 0)}))}}parser$3=parser$8,BottleneckError$1=BottleneckError_1,RedisConnection$1=RedisConnection_1,IORedisConnection$1=IORedisConnection_1,RedisDatastore$1=class{constructor(e,t,r){this.instance=e,this.storeOptions=t,this.originalId=this.instance.id,this.clientId=this.instance._randomIndex(),parser$3.load(r,r,this),this.clients={},this.capacityPriorityCounters={},this.sharedConnection=null!=this.connection,null==this.connection&&(this.connection="redis"===this.instance.datastore?new RedisConnection$1({Redis:this.Redis,clientOptions:this.clientOptions,Promise:this.Promise,Events:this.instance.Events}):"ioredis"===this.instance.datastore?new IORedisConnection$1({Redis:this.Redis,clientOptions:this.clientOptions,clusterNodes:this.clusterNodes,Promise:this.Promise,Events:this.instance.Events}):void 0),this.instance.connection=this.connection,this.instance.datastore=this.connection.datastore,this.ready=this.connection.ready.then((e=>(this.clients=e,this.runScript("init",this.prepareInitSettings(this.clearDatastore))))).then((()=>this.connection.__addLimiter__(this.instance))).then((()=>this.runScript("register_client",[this.instance.queued()]))).then((()=>{var e;return"function"==typeof(e=this.heartbeat=setInterval((()=>this.runScript("heartbeat",[]).catch((e=>this.instance.Events.trigger("error",e)))),this.heartbeatInterval)).unref&&e.unref(),this.clients}))}__publish__(e){var t=this;return _asyncToGenerator$3((function*(){return(yield t.ready).client.publish(t.instance.channel(),`message:${e.toString()}`)}))()}onMessage(e,t){var r=this;return _asyncToGenerator$3((function*(){var e,n,i,s,o,a,u,c,l,p;try{u=t.indexOf(":");var h=[t.slice(0,u),t.slice(u+1)];if(i=h[1],"capacity"===(p=h[0]))return yield r.instance._drainAll(i.length>0?~~i:void 0);if("capacity-priority"===p){var d=_slicedToArray$2(i.split(":"),3);return l=d[0],c=d[1],n=d[2],e=l.length>0?~~l:void 0,c===r.clientId?(s=yield r.instance._drainAll(e),a=null!=e?e-(s||0):"",yield r.clients.client.publish(r.instance.channel(),`capacity-priority:${a}::${n}`)):""===c?(clearTimeout(r.capacityPriorityCounters[n]),delete r.capacityPriorityCounters[n],r.instance._drainAll(e)):r.capacityPriorityCounters[n]=setTimeout(_asyncToGenerator$3((function*(){var t;try{return delete r.capacityPriorityCounters[n],yield r.runScript("blacklist_client",[c]),yield r.instance._drainAll(e)}catch(e){return t=e,r.instance.Events.trigger("error",t)}})),1e3)}if("message"===p)return r.instance.Events.trigger("message",i);if("blocked"===p)return yield r.instance._dropAllQueued()}catch(e){return o=e,r.instance.Events.trigger("error",o)}}))()}__disconnect__(e){return clearInterval(this.heartbeat),this.sharedConnection?this.connection.__removeLimiter__(this.instance):this.connection.disconnect(e)}runScript(e,t){var r=this;return _asyncToGenerator$3((function*(){return"init"!==e&&"register_client"!==e&&(yield r.ready),new r.Promise(((n,i)=>{var s,o;return s=[Date.now(),r.clientId].concat(t),r.instance.Events.trigger("debug",`Calling Redis script: ${e}.lua`,s),o=r.connection.__scriptArgs__(e,r.originalId,s,(function(e,t){return null!=e?i(e):n(t)})),r.connection.__scriptFn__(e)(...o)})).catch((n=>"SETTINGS_KEY_NOT_FOUND"===n.message?"heartbeat"===e?r.Promise.resolve():r.runScript("init",r.prepareInitSettings(!1)).then((()=>r.runScript(e,t))):"UNKNOWN_CLIENT"===n.message?r.runScript("register_client",[r.instance.queued()]).then((()=>r.runScript(e,t))):r.Promise.reject(n)))}))()}prepareArray(e){var t,r,n,i;for(n=[],t=0,r=e.length;t<r;t++)i=e[t],n.push(null!=i?i.toString():"");return n}prepareObject(e){var t,r,n;for(r in t=[],e)n=e[r],t.push(r,null!=n?n.toString():"");return t}prepareInitSettings(e){var t;return(t=this.prepareObject(Object.assign({},this.storeOptions,{id:this.originalId,version:this.instance.version,groupTimeout:this.timeout,clientTimeout:this.clientTimeout}))).unshift(e?1:0,this.instance.version),t}convertBool(e){return!!e}__updateSettings__(e){var t=this;return _asyncToGenerator$3((function*(){return yield t.runScript("update_settings",t.prepareObject(e)),parser$3.overwrite(e,e,t.storeOptions)}))()}__running__(){return this.runScript("running",[])}__queued__(){return this.runScript("queued",[])}__done__(){return this.runScript("done",[])}__groupCheck__(){var e=this;return _asyncToGenerator$3((function*(){return e.convertBool(yield e.runScript("group_check",[]))}))()}__incrementReservoir__(e){return this.runScript("increment_reservoir",[e])}__currentReservoir__(){return this.runScript("current_reservoir",[])}__check__(e){var t=this;return _asyncToGenerator$3((function*(){return t.convertBool(yield t.runScript("check",t.prepareArray([e])))}))()}__register__(e,t,r){var n=this;return _asyncToGenerator$3((function*(){var i,s,o,a=_slicedToArray$2(yield n.runScript("register",n.prepareArray([e,t,r])),3);return s=a[0],o=a[1],i=a[2],{success:n.convertBool(s),wait:o,reservoir:i}}))()}__submit__(e,t){var r=this;return _asyncToGenerator$3((function*(){var n,i,s,o,a;try{var u=_slicedToArray$2(yield r.runScript("submit",r.prepareArray([e,t])),3);return o=u[0],n=u[1],a=u[2],{reachedHWM:r.convertBool(o),blocked:r.convertBool(n),strategy:a}}catch(e){if(0===(i=e).message.indexOf("OVERWEIGHT")){var c=_slicedToArray$2(i.message.split(":"),3);throw t=c[1],s=c[2],new BottleneckError$1(`Impossible to add a job having a weight of ${t} to a limiter having a maxConcurrent setting of ${s}`)}throw i}}))()}__free__(e,t){var r=this;return _asyncToGenerator$3((function*(){return{running:yield r.runScript("free",r.prepareArray([e]))}}))()}};var RedisDatastore_1=RedisDatastore$1,BottleneckError,States$1;BottleneckError=BottleneckError_1,States$1=class{constructor(e){this.status=e,this._jobs={},this.counts=this.status.map((function(){return 0}))}next(e){var t,r;return r=(t=this._jobs[e])+1,null!=t&&r<this.status.length?(this.counts[t]--,this.counts[r]++,this._jobs[e]++):null!=t?(this.counts[t]--,delete this._jobs[e]):void 0}start(e){return 0,this._jobs[e]=0,this.counts[0]++}remove(e){var t;return null!=(t=this._jobs[e])&&(this.counts[t]--,delete this._jobs[e]),null!=t}jobStatus(e){var t;return null!=(t=this.status[this._jobs[e]])?t:null}statusJobs(e){var t,r,n,i;if(null!=e){if((r=this.status.indexOf(e))<0)throw new BottleneckError(`status must be one of ${this.status.join(", ")}`);for(t in i=[],n=this._jobs)n[t]===r&&i.push(t);return i}return Object.keys(this._jobs)}statusCounts(){return this.counts.reduce(((e,t,r)=>(e[this.status[r]]=t,e)),{})}};var States_1=States$1,DLList,Sync$1;function asyncGeneratorStep$2(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator$2(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){asyncGeneratorStep$2(s,n,i,o,a,"next",e)}function a(e){asyncGeneratorStep$2(s,n,i,o,a,"throw",e)}o(void 0)}))}}DLList=DLList_1,Sync$1=class{constructor(e,t){this.schedule=this.schedule.bind(this),this.name=e,this.Promise=t,this._running=0,this._queue=new DLList}isEmpty(){return 0===this._queue.length}_tryToRun(){var e=this;return _asyncToGenerator$2((function*(){var t,r,n,i,s,o,a;if(e._running<1&&e._queue.length>0){e._running++;var u=e._queue.shift();return a=u.task,t=u.args,s=u.resolve,i=u.reject,r=yield _asyncToGenerator$2((function*(){try{return o=yield a(...t),function(){return s(o)}}catch(e){return n=e,function(){return i(n)}}}))(),e._running--,e._tryToRun(),r()}}))()}schedule(e,...t){var r,n,i;return i=n=null,r=new this.Promise((function(e,t){return i=e,n=t})),this._queue.push({task:e,args:t,resolve:i,reject:n}),this._tryToRun(),r}};var Sync_1=Sync$1,version="2.19.5",require$$8={version:version},Events$2,Group,IORedisConnection,RedisConnection,Scripts,parser$2;function _slicedToArray$1(e,t){return _arrayWithHoles$1(e)||_iterableToArrayLimit$1(e,t)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit$1(e,t){var r=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return r}function _arrayWithHoles$1(e){if(Array.isArray(e))return e}function asyncGeneratorStep$1(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator$1(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){asyncGeneratorStep$1(s,n,i,o,a,"next",e)}function a(e){asyncGeneratorStep$1(s,n,i,o,a,"throw",e)}o(void 0)}))}}parser$2=parser$8,Events$2=Events_1,RedisConnection=RedisConnection_1,IORedisConnection=IORedisConnection_1,Scripts=Scripts$3,Group=function(){class e{constructor(e={}){this.deleteKey=this.deleteKey.bind(this),this.limiterOptions=e,parser$2.load(this.limiterOptions,this.defaults,this),this.Events=new Events$2(this),this.instances={},this.Bottleneck=Bottleneck_1,this._startAutoCleanup(),this.sharedConnection=null!=this.connection,null==this.connection&&("redis"===this.limiterOptions.datastore?this.connection=new RedisConnection(Object.assign({},this.limiterOptions,{Events:this.Events})):"ioredis"===this.limiterOptions.datastore&&(this.connection=new IORedisConnection(Object.assign({},this.limiterOptions,{Events:this.Events}))))}key(e=""){var t;return null!=(t=this.instances[e])?t:(()=>{var t;return t=this.instances[e]=new this.Bottleneck(Object.assign(this.limiterOptions,{id:`${this.id}-${e}`,timeout:this.timeout,connection:this.connection})),this.Events.trigger("created",t,e),t})()}deleteKey(e=""){var t=this;return _asyncToGenerator$1((function*(){var r,n;return n=t.instances[e],t.connection&&(r=yield t.connection.__runCommand__(["del",...Scripts.allKeys(`${t.id}-${e}`)])),null!=n&&(delete t.instances[e],yield n.disconnect()),null!=n||r>0}))()}limiters(){var e,t,r,n;for(e in r=[],t=this.instances)n=t[e],r.push({key:e,limiter:n});return r}keys(){return Object.keys(this.instances)}clusterKeys(){var e=this;return _asyncToGenerator$1((function*(){var t,r,n,i,s,o,a,u;if(null==e.connection)return e.Promise.resolve(e.keys());for(o=[],t=null,u=`b_${e.id}-`.length,r="_settings".length;0!==t;){var c=_slicedToArray$1(yield e.connection.__runCommand__(["scan",null!=t?t:0,"match",`b_${e.id}-*_settings`,"count",1e4]),2);for(t=~~c[0],i=0,a=(n=c[1]).length;i<a;i++)s=n[i],o.push(s.slice(u,-r))}return o}))()}_startAutoCleanup(){var e,t=this;return clearInterval(this.interval),"function"==typeof(e=this.interval=setInterval(_asyncToGenerator$1((function*(){var e,r,n,i,s,o;for(r in s=Date.now(),i=[],n=t.instances){o=n[r];try{(yield o._store.__groupCheck__(s))?i.push(t.deleteKey(r)):i.push(void 0)}catch(t){e=t,i.push(o.Events.trigger("error",e))}}return i})),this.timeout/2)).unref?e.unref():void 0}updateSettings(e={}){if(parser$2.overwrite(e,this.defaults,this),parser$2.overwrite(e,e,this.limiterOptions),null!=e.timeout)return this._startAutoCleanup()}disconnect(e=!0){var t;if(!this.sharedConnection)return null!=(t=this.connection)?t.disconnect(e):void 0}}return e.prototype.defaults={timeout:3e5,connection:null,Promise:Promise,id:"group-key"},e}.call(void 0);var Group_1=Group,Batcher,Events$1,parser$1;parser$1=parser$8,Events$1=Events_1,Batcher=function(){class e{constructor(e={}){this.options=e,parser$1.load(this.options,this.defaults,this),this.Events=new Events$1(this),this._arr=[],this._resetPromise(),this._lastFlush=Date.now()}_resetPromise(){return this._promise=new this.Promise(((e,t)=>this._resolve=e))}_flush(){return clearTimeout(this._timeout),this._lastFlush=Date.now(),this._resolve(),this.Events.trigger("batch",this._arr),this._arr=[],this._resetPromise()}add(e){var t;return this._arr.push(e),t=this._promise,this._arr.length===this.maxSize?this._flush():null!=this.maxTime&&1===this._arr.length&&(this._timeout=setTimeout((()=>this._flush()),this.maxTime)),t}}return e.prototype.defaults={maxTime:null,maxSize:null,Promise:Promise},e}.call(void 0);var Batcher_1=Batcher;function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_nonIterableRest()}function _iterableToArrayLimit(e,t){var r=[],n=!0,i=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(n=(o=a.next()).done)&&(r.push(o.value),!t||r.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==a.return||a.return()}finally{if(i)throw s}}return r}function _toArray(e){return _arrayWithHoles(e)||_iterableToArray(e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,t,r,n,i,s,o){try{var a=e[s](o),u=a.value}catch(e){return void r(e)}a.done?t(u):Promise.resolve(u).then(n,i)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var s=e.apply(t,r);function o(e){asyncGeneratorStep(s,n,i,o,a,"next",e)}function a(e){asyncGeneratorStep(s,n,i,o,a,"throw",e)}o(void 0)}))}}var Bottleneck,DEFAULT_PRIORITY,Events,Job,LocalDatastore,NUM_PRIORITIES,Queues,RedisDatastore,States,Sync,parser,splice=[].splice;NUM_PRIORITIES=10,DEFAULT_PRIORITY=5,parser=parser$8,Queues=Queues_1,Job=Job_1,LocalDatastore=LocalDatastore_1,RedisDatastore=RedisDatastore_1,Events=Events_1,States=States_1,Sync=Sync_1,Bottleneck=function(){class e{constructor(t={},...r){var n,i;this._addToQueue=this._addToQueue.bind(this),this._validateOptions(t,r),parser.load(t,this.instanceDefaults,this),this._queues=new Queues(NUM_PRIORITIES),this._scheduled={},this._states=new States(["RECEIVED","QUEUED","RUNNING","EXECUTING"].concat(this.trackDoneStatus?["DONE"]:[])),this._limiter=null,this.Events=new Events(this),this._submitLock=new Sync("submit",this.Promise),this._registerLock=new Sync("register",this.Promise),i=parser.load(t,this.storeDefaults,{}),this._store=function(){if("redis"===this.datastore||"ioredis"===this.datastore||null!=this.connection)return n=parser.load(t,this.redisStoreDefaults,{}),new RedisDatastore(this,i,n);if("local"===this.datastore)return n=parser.load(t,this.localStoreDefaults,{}),new LocalDatastore(this,i,n);throw new e.prototype.BottleneckError(`Invalid datastore type: ${this.datastore}`)}.call(this),this._queues.on("leftzero",(()=>{var e;return null!=(e=this._store.heartbeat)&&"function"==typeof e.ref?e.ref():void 0})),this._queues.on("zero",(()=>{var e;return null!=(e=this._store.heartbeat)&&"function"==typeof e.unref?e.unref():void 0}))}_validateOptions(t,r){if(null==t||"object"!=typeof t||0!==r.length)throw new e.prototype.BottleneckError("Bottleneck v2 takes a single object argument. Refer to https://github.com/SGrondin/bottleneck#upgrading-to-v2 if you're upgrading from Bottleneck v1.")}ready(){return this._store.ready}clients(){return this._store.clients}channel(){return`b_${this.id}`}channel_client(){return`b_${this.id}_${this._store.clientId}`}publish(e){return this._store.__publish__(e)}disconnect(e=!0){return this._store.__disconnect__(e)}chain(e){return this._limiter=e,this}queued(e){return this._queues.queued(e)}clusterQueued(){return this._store.__queued__()}empty(){return 0===this.queued()&&this._submitLock.isEmpty()}running(){return this._store.__running__()}done(){return this._store.__done__()}jobStatus(e){return this._states.jobStatus(e)}jobs(e){return this._states.statusJobs(e)}counts(){return this._states.statusCounts()}_randomIndex(){return Math.random().toString(36).slice(2)}check(e=1){return this._store.__check__(e)}_clearGlobalState(e){return null!=this._scheduled[e]&&(clearTimeout(this._scheduled[e].expiration),delete this._scheduled[e],!0)}_free(e,t,r,n){var i=this;return _asyncToGenerator((function*(){var t,s;try{if(s=(yield i._store.__free__(e,r.weight)).running,i.Events.trigger("debug",`Freed ${r.id}`,n),0===s&&i.empty())return i.Events.trigger("idle")}catch(e){return t=e,i.Events.trigger("error",t)}}))()}_run(e,t,r){var n,i,s;return t.doRun(),n=this._clearGlobalState.bind(this,e),s=this._run.bind(this,e,t),i=this._free.bind(this,e,t),this._scheduled[e]={timeout:setTimeout((()=>t.doExecute(this._limiter,n,s,i)),r),expiration:null!=t.options.expiration?setTimeout((function(){return t.doExpire(n,s,i)}),r+t.options.expiration):void 0,job:t}}_drainOne(e){return this._registerLock.schedule((()=>{var t,r,n,i,s;if(0===this.queued())return this.Promise.resolve(null);s=this._queues.getFirst();var o=n=s.first();return i=o.options,t=o.args,null!=e&&i.weight>e?this.Promise.resolve(null):(this.Events.trigger("debug",`Draining ${i.id}`,{args:t,options:i}),r=this._randomIndex(),this._store.__register__(r,i.weight,i.expiration).then((({success:e,wait:o,reservoir:a})=>{var u;return this.Events.trigger("debug",`Drained ${i.id}`,{success:e,args:t,options:i}),e?(s.shift(),(u=this.empty())&&this.Events.trigger("empty"),0===a&&this.Events.trigger("depleted",u),this._run(r,n,o),this.Promise.resolve(i.weight)):this.Promise.resolve(null)})))}))}_drainAll(e,t=0){return this._drainOne(e).then((r=>{var n;return null!=r?(n=null!=e?e-r:e,this._drainAll(n,t+r)):this.Promise.resolve(t)})).catch((e=>this.Events.trigger("error",e)))}_dropAllQueued(e){return this._queues.shiftAll((function(t){return t.doDrop({message:e})}))}stop(t={}){var r,n;return t=parser.load(t,this.stopDefaults),n=e=>{var t;return t=()=>{var t;return(t=this._states.counts)[0]+t[1]+t[2]+t[3]===e},new this.Promise(((e,r)=>t()?e():this.on("done",(()=>{if(t())return this.removeAllListeners("done"),e()}))))},r=t.dropWaitingJobs?(this._run=function(e,r){return r.doDrop({message:t.dropErrorMessage})},this._drainOne=()=>this.Promise.resolve(null),this._registerLock.schedule((()=>this._submitLock.schedule((()=>{var e,r,i;for(e in r=this._scheduled)i=r[e],"RUNNING"===this.jobStatus(i.job.options.id)&&(clearTimeout(i.timeout),clearTimeout(i.expiration),i.job.doDrop({message:t.dropErrorMessage}));return this._dropAllQueued(t.dropErrorMessage),n(0)}))))):this.schedule({priority:NUM_PRIORITIES-1,weight:0},(()=>n(1))),this._receive=function(r){return r._reject(new e.prototype.BottleneckError(t.enqueueErrorMessage))},this.stop=()=>this.Promise.reject(new e.prototype.BottleneckError("stop() has already been called")),r}_addToQueue(t){var r=this;return _asyncToGenerator((function*(){var n,i,s,o,a,u,c;n=t.args,o=t.options;try{var l=yield r._store.__submit__(r.queued(),o.weight);a=l.reachedHWM,i=l.blocked,c=l.strategy}catch(e){return s=e,r.Events.trigger("debug",`Could not queue ${o.id}`,{args:n,options:o,error:s}),t.doDrop({error:s}),!1}return i?(t.doDrop(),!0):a&&(null!=(u=c===e.prototype.strategy.LEAK?r._queues.shiftLastFrom(o.priority):c===e.prototype.strategy.OVERFLOW_PRIORITY?r._queues.shiftLastFrom(o.priority+1):c===e.prototype.strategy.OVERFLOW?t:void 0)&&u.doDrop(),null==u||c===e.prototype.strategy.OVERFLOW)?(null==u&&t.doDrop(),a):(t.doQueue(a,i),r._queues.push(t),yield r._drainAll(),a)}))()}_receive(t){return null!=this._states.jobStatus(t.options.id)?(t._reject(new e.prototype.BottleneckError(`A job with the same id already exists (id=${t.options.id})`)),!1):(t.doReceive(),this._submitLock.schedule(this._addToQueue,t))}submit(...e){var t,r,n,i,s,o,a,u;"function"==typeof e[0]?(s=_toArray(e),r=s[0],e=s.slice(1),o=_slicedToArray(splice.call(e,-1),1),t=o[0],i=parser.load({},this.jobDefaults)):(i=(a=_toArray(e))[0],r=a[1],e=a.slice(2),u=_slicedToArray(splice.call(e,-1),1),t=u[0],i=parser.load(i,this.jobDefaults));return(n=new Job(((...e)=>new this.Promise((function(t,n){return r(...e,(function(...e){return(null!=e[0]?n:t)(e)}))}))),e,i,this.jobDefaults,this.rejectOnDrop,this.Events,this._states,this.Promise)).promise.then((function(e){return"function"==typeof t?t(...e):void 0})).catch((function(e){return Array.isArray(e)?"function"==typeof t?t(...e):void 0:"function"==typeof t?t(e):void 0})),this._receive(n)}schedule(...e){var t,r,n;if("function"==typeof e[0]){var i=_toArray(e);n=i[0],e=i.slice(1),r={}}else{var s=_toArray(e);r=s[0],n=s[1],e=s.slice(2)}return t=new Job(n,e,r,this.jobDefaults,this.rejectOnDrop,this.Events,this._states,this.Promise),this._receive(t),t.promise}wrap(e){var t,r;return t=this.schedule.bind(this),(r=function(...r){return t(e.bind(this),...r)}).withOptions=function(r,...n){return t(r,e,...n)},r}updateSettings(e={}){var t=this;return _asyncToGenerator((function*(){return yield t._store.__updateSettings__(parser.overwrite(e,t.storeDefaults)),parser.overwrite(e,t.instanceDefaults,t),t}))()}currentReservoir(){return this._store.__currentReservoir__()}incrementReservoir(e=0){return this._store.__incrementReservoir__(e)}}return e.default=e,e.Events=Events,e.version=e.prototype.version=require$$8.version,e.strategy=e.prototype.strategy={LEAK:1,OVERFLOW:2,OVERFLOW_PRIORITY:4,BLOCK:3},e.BottleneckError=e.prototype.BottleneckError=BottleneckError_1,e.Group=e.prototype.Group=Group_1,e.RedisConnection=e.prototype.RedisConnection=RedisConnection_1,e.IORedisConnection=e.prototype.IORedisConnection=IORedisConnection_1,e.Batcher=e.prototype.Batcher=Batcher_1,e.prototype.jobDefaults={priority:DEFAULT_PRIORITY,weight:1,expiration:null,id:"<no-id>"},e.prototype.storeDefaults={maxConcurrent:null,minTime:0,highWater:null,strategy:e.prototype.strategy.LEAK,penalty:null,reservoir:null,reservoirRefreshInterval:null,reservoirRefreshAmount:null,reservoirIncreaseInterval:null,reservoirIncreaseAmount:null,reservoirIncreaseMaximum:null},e.prototype.localStoreDefaults={Promise:Promise,timeout:null,heartbeatInterval:250},e.prototype.redisStoreDefaults={Promise:Promise,timeout:null,heartbeatInterval:5e3,clientTimeout:1e4,Redis:null,clientOptions:{},clusterNodes:null,clearDatastore:!1,connection:null},e.prototype.instanceDefaults={datastore:"local",connection:null,id:"<no-id>",rejectOnDrop:!0,trackDoneStatus:!1,Promise:Promise},e.prototype.stopDefaults={enqueueErrorMessage:"This limiter has been stopped and cannot accept new jobs.",dropWaitingJobs:!0,dropErrorMessage:"This limiter has been stopped."},e}.call(void 0);var Bottleneck_1=Bottleneck,lib=Bottleneck_1,CHUNK_SIZE=1048576,Uploader=function(){function e(){_classCallCheck(this,e),this.files={},this.events={}}var t,r,n,i,s;return _createClass(e,[{key:"setClient",value:function(e){this.client=e}},{key:"hasUploads",value:function(){return Object.keys(this.files).length>0}},{key:"addFile",value:function(e,t,r,n,i,s,o){for(var a=Buffer.byteLength(r),u=new UploadFile(this,e,t,r,a,i,n,s,o),c=Math.max(Math.ceil(a/CHUNK_SIZE),1),l=0;l<c;l++){var p=l*CHUNK_SIZE,h=Math.min(a,(l+1)*CHUNK_SIZE),d=h-p,f="".concat(l,"_").concat(c);u.addChunk(f,{offset:l,maxOffset:c,startByte:p,endByte:h,size:d})}this.files[e]=u}},{key:"upload",value:(s=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this.files[t]).isComplete){e.next=4;break}return e.next=4,r.upload();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"uploadAll",value:function(){for(var e=0,t=Object.keys(this.files);e<t.length;e++){var r=t[e];this.upload(r)}}},{key:"complete",value:function(){for(var e=0,t=Object.values(this.files);e<t.length;e++){if(!t[e].isComplete)return}this.emit("complete")}},{key:"resume",value:(i=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this.files[t]).isComplete){e.next=4;break}return e.next=4,r.resume();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"resumeAll",value:function(){for(var e=0,t=Object.keys(this.files);e<t.length;e++){var r=t[e];this.resume(r)}this.emit("resumed")}},{key:"pause",value:(n=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this.files[t]).isComplete){e.next=4;break}return e.next=4,r.pause();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"pauseAll",value:function(){for(var e=0,t=Object.keys(this.files);e<t.length;e++){var r=t[e];this.pause(r)}this.emit("paused")}},{key:"cancel",value:(r=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=this.files[t]).isComplete){e.next=4;break}return e.next=4,r.cancel();case 4:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"cancelAll",value:function(){for(var e=0,t=Object.keys(this.files);e<t.length;e++){var r=t[e];this.cancel(r)}this.emit("cancelled")}},{key:"remove",value:function(e){this.cancel(e),delete this.files[e]}},{key:"reset",value:function(){for(var e=0,t=Object.keys(this.files);e<t.length;e++){var r=t[e];this.remove(r)}this.emit("cancelled"),this.emit("reset")}},{key:"on",value:function(e,t){e in this.events||(this.events[e]=[]),this.events[e].push(t)}},{key:"emit",value:function(e,t){if(e in this.events){var r,n=_createForOfIteratorHelper(this.events[e]);try{for(n.s();!(r=n.n()).done;){(0,r.value)(t)}}catch(e){n.e(e)}finally{n.f()}}}},{key:"put",value:(t=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t,r,n,i,s){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,axios.put(t,r,{cancelToken:i,headers:{"Content-Type":n},onUploadProgress:s});case 2:case"end":return e.stop()}}),e)}))),function(e,r,n,i,s){return t.apply(this,arguments)})}]),e}(),UploadFile=function(){function e(t,r,n,i,s,o,a,u,c){_classCallCheck(this,e),this.uploader=t,this.ref=r,this.name=n,this.buffer=i,this.size=s,this.repositoryId=o,this.parentContentId=c,this.contentType=a,this.actions=u,this.chunks={},this.target=null,this.isComplete=!1}var t,r,n,i,s,o,a;return _createClass(e,[{key:"upload",value:(a=_asyncToGenerator$9(regeneratorRuntime.mark((function e(){var t,r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ref,e.prev=1,e.next=4,this.uploader.client.query("query upload($repositoryId: ID!, $contentType: String!, $chunks: JSON) { \n                    upload(repositoryId: $repositoryId, contentType: $contentType, chunks: $chunks) {\n                            url\n                            key\n                            chunks\n                        }\n                    }",{repositoryId:this.repositoryId,contentType:this.contentType,chunks:this.chunks});case 4:r=e.sent,n=r.data.upload,this.target=n,e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(1),e.abrupt("return",this.uploader.emit("error",{ref:t,error:e.t0}));case 12:for(i in this.chunks)this.chunks[i].isComplete||(this.chunks[i]=Object.assign(this.chunks[i],this.target.chunks[i]));return e.next=15,this.uploadChunks();case 15:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(){return a.apply(this,arguments)})},{key:"uploadChunks",value:(o=_asyncToGenerator$9(regeneratorRuntime.mark((function e(){var t,r,n,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r in t=this.ref,this.uploader.emit("uploading",{ref:t}),e.prev=2,this.queue=new lib({maxConcurrent:3}),this.chunks)this.chunks[r].isComplete||(this.chunks[r].loaded=0);return n=Object.keys(this.chunks).filter((function(e){return!i.chunks[e].isComplete})).map((function(e){return i.queue.schedule((function(){return i.uploadChunk(e)}))})),e.next=8,Promise.all(n);case 8:return e.next=10,this.complete();case 10:e.next=17;break;case 12:if(e.prev=12,e.t0=e.catch(2),"BottleneckError"!=e.t0.constructor.name){e.next=16;break}return e.abrupt("return");case 16:this.uploader.emit("error",{ref:t,error:e.t0});case 17:case"end":return e.stop()}}),e,this,[[2,12]])}))),function(){return o.apply(this,arguments)})},{key:"complete",value:(s=_asyncToGenerator$9(regeneratorRuntime.mark((function e(){var t,r,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ref,e.prev=1,e.next=4,this.uploader.client.query("query uploadCallback($key: String, $contentType: String!, $name: String!, $repositoryId: ID!, $actions: [String], $chunks: JSON, $parentContentId: ID) { \n                uploadCallback(key: $key, contentType: $contentType, name: $name, repositoryId: $repositoryId, actions: $actions, chunks: $chunks, parentContentId: $parentContentId) {\n                            id\n                            name\n                            data\n                        }\n                    }",{key:this.target.key,contentType:this.contentType,name:this.name,repositoryId:this.repositoryId,actions:this.actions,parentContentId:this.parentContentId,chunks:this.chunks});case 4:r=e.sent,n=r.data,i=n.uploadCallback,this.isComplete=!0,this.uploader.emit("fileComplete",{ref:t,content:i}),this.uploader.complete(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),this.uploader.emit("error",{ref:t,error:e.t0});case 15:case"end":return e.stop()}}),e,this,[[1,12]])}))),function(){return s.apply(this,arguments)})},{key:"addChunk",value:function(e,t){this.chunks[e]=t,this.chunks[e].isComplete=!1}},{key:"add",value:function(e,t){this.chunks[e]=t}},{key:"uploadChunk",value:(i=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t){var r,n,i,s,o,a,u=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=axios.CancelToken,n=r.source(),this.chunks[t].cancelSource=n,i=this.buffer.slice(this.chunks[t].startByte,this.chunks[t].endByte),s=this.ref,e.next=7,this.uploader.put(this.chunks[t].url,i,this.contentType,n.token,(function(e){var r=e.loaded,n=e.total,i=u.chunks[t].offset,o=u.chunks[t].maxOffset;u.uploader.emit("chunkProgress",{ref:s,loaded:r,total:n,maxOffset:o,offset:i}),u.chunks[t].loaded=r,u.progress()}));case 7:this.chunks[t].isComplete=!0,this.chunks[t].loaded=this.chunks[t].size,o=this.chunks[t].offset,a=this.chunks[t].maxOffset,this.uploader.emit("chunkProgress",{ref:s,loaded:this.chunks[t].size,total:this.chunks[t].size,maxOffset:a,offset:o}),this.progress();case 13:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"progress",value:function(){var e=this.size,t=0;for(var r in this.chunks)t+=this.chunks[r].loaded;this.uploader.emit("progress",{ref:this.ref,loaded:t,total:e})}},{key:"resume",value:(n=_asyncToGenerator$9(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.uploader.emit("fileResumed",{ref:this.ref,chunks:this.chunks}),e.next=3,this.upload();case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"pause",value:(r=_asyncToGenerator$9(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t in this.chunks)"cancelSource"in this.chunks[t]&&this.chunks[t].cancelSource.cancel();if(!this.queue){e.next=4;break}return e.next=4,this.queue.stop();case 4:this.uploader.emit("filePaused",{ref:this.ref,chunks:this.chunks});case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"cancel",value:(t=_asyncToGenerator$9(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t in this.queue&&this.queue.stop(),this.chunks)"cancelSource"in(r=this.chunks[t])&&r.cancelSource.cancel();this.isComplete=!0,this.uploader.emit("fileCancelled",{ref:this.ref});case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),e}(),Utils=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"calcReadingTime",value:function(e){var t=1,r=e.split(" ").length;return r>0&&(t=Math.ceil(r/200)),t}}]),e}(),DEFAULT_TIMEOUT=1e4,Client=function(){function e(){var t=this;_classCallCheck(this,e),this.debug=!1,this.options={timeout:DEFAULT_TIMEOUT,headers:{"Unalike-Agent":"unalike.js-".concat(version$2),"Content-Type":"application/json; charset=utf-8"}},this.content=function(e){var r=new ContentResource(t);return e&&r.id(e),r},this.repository=function(e){var r=new RepositoryResource(t);return e&&r.id(e),r},this.model=function(e){var r=new ModelResource(t);return e&&r.id(e),r},this.interceptors={request:new Interceptors,fulfilled:new Interceptors,rejected:new Interceptors}}var t,r,n,i,s,o,a;return _createClass(e,[{key:"setTimeout",value:function(e){this.options.timeout=e}},{key:"setOption",value:function(e,t){this.options[e]=t}},{key:"setApi",value:function(e){this.url=e}},{key:"setDebug",value:function(e){this.debug=e}},{key:"getUrl",value:function(){return this.url}},{key:"getVersion",value:function(){return"unalike.js-".concat(version$2)}},{key:"setToken",value:function(e){if(null!=e){if(this.token=e,e.indexOf("__")>-1&&e.indexOf("__")<40){var t=e.split("__")[0];this.url=t.indexOf("localhost")>-1?"http://".concat(t):"https://".concat(t)}this.options.headers["x-auth"]=e}}},{key:"setHeader",value:function(e,t){this.options.headers[e]=t}},{key:"buildUrl",value:function(e,t){var r="";for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];r+="".concat(encodeURIComponent(n),"=").concat(encodeURIComponent(i),"&")}return r.length>0&&(r=r.substring(0,r.length-1),e="".concat(e,"?").concat(r)),e}},{key:"requiresToken",value:function(){if(void 0===this.token||null===this.token)throw new Error("Where's the key?")}},{key:"ping",value:(a=_asyncToGenerator$9(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request("".concat(this.url,"/ping"),Object.assign(this.options,{method:"GET"}));case 2:return t=e.sent,this.debug,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"get",value:(o=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t,r,n){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.buildUrl("".concat(this.url).concat(t),r),e.next=3,this.request(i,Object.assign({},this.options,{method:"GET"},n));case 3:return s=e.sent,this.debug,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return o.apply(this,arguments)})},{key:"post",value:(s=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t,r,n,i){var s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=this.buildUrl("".concat(this.url).concat(t),r),e.next=3,this.request(s,Object.assign({},this.options,{method:"POST",data:n},i));case 3:return o=e.sent,this.debug,e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return s.apply(this,arguments)})},{key:"put",value:(i=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t,r,n,i){var s,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.requiresToken(),s=this.buildUrl("".concat(this.url).concat(t),r),e.next=4,this.request(s,Object.assign({},this.options,{method:"PUT",data:n},i));case 4:return o=e.sent,this.debug,e.abrupt("return",o);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r,n){return i.apply(this,arguments)})},{key:"delete",value:(n=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t,r,n){var i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.requiresToken(),i=this.buildUrl("".concat(this.url).concat(t),r),e.next=4,this.request(i,Object.assign({},this.options,{method:"DELETE"},n));case 4:return s=e.sent,this.debug,e.abrupt("return",s);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"query",value:(r=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t,r){var n,i,s,o=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>2&&void 0!==o[2]?o[2]:"/query",i=this.buildUrl("".concat(this.url).concat(n)),e.next=4,this.request(i,Object.assign({},this.options,{method:"POST",data:{query:t,variables:r}}));case 4:if(!((s=e.sent)&&s.data.errors&&s.data.errors.length>0)){e.next=7;break}throw new UnalikeQueryError(s);case 7:return s.data=s.data.data,this.debug,e.abrupt("return",s);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"request",value:(t=_asyncToGenerator$9(regeneratorRuntime.mark((function e(t,r){var n,i,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=setTimeout((function(){throw new Error("Request timed out")}),r.timeout),e.prev=1,this.interceptors.request.forEach({url:t,options:r}),e.next=5,axios(t,r);case 5:if(i=e.sent,clearTimeout(n),!((i={headers:i.headers,status:i.status,data:i.data}).status>=400)){e.next=12;break}throw new UnalikeError({url:t,options:r,response:i});case 12:this.interceptors.fulfilled.forEach({url:t,options:r,response:i});case 13:return e.abrupt("return",i);case 16:if(e.prev=16,e.t0=e.catch(1),clearTimeout(n),!("response"in e.t0)){e.next=24;break}throw i={headers:e.t0.response.headers,status:e.t0.response.status,data:e.t0.response.data},s=new UnalikeError(i),this.interceptors.rejected.forEach({url:t,options:r,error:s}),s;case 24:throw e.t0;case 25:case"end":return e.stop()}}),e,this,[[1,16]])}))),function(e,r){return t.apply(this,arguments)})}]),e}(),index={Client:Client,Transformer:Transformer,Utils:Utils,Uploader:Uploader};return index}));
